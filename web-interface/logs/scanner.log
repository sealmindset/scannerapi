[2025-03-21 13:32:12] [INFO] [main] Clearing account cache before scan
[2025-03-21 13:32:12] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 13:32:12] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 13:32:12] [INFO] [main] Creating test accounts for scan
[2025-03-21 13:32:12] [WARNING] [main] Failed to create test account: test1742581932@example.com, status: 404
[2025-03-21 13:32:12] [WARNING] [main] Failed to create test account: test1742581933@example.com, status: 404
[2025-03-21 13:32:12] [WARNING] [main] Failed to create test account: test1742581934@example.com, status: 404
[2025-03-21 13:32:12] [INFO] [orchestrator] Starting API security scan
[2025-03-21 13:32:12] [INFO] [orchestrator] Loading configuration from configs/vampi.yaml
[2025-03-21 13:32:12] [ERROR] [config] Configuration file not found: configs/vampi.yaml
[2025-03-21 13:32:12] [CRITICAL] [orchestrator] Failed to load configuration: Configuration file not found: configs/vampi.yaml
[2025-03-21 13:32:12] [CRITICAL] [orchestrator] Scan failed: Configuration error: Configuration file not found: configs/vampi.yaml
[2025-03-21 13:34:32] [INFO] [main] Clearing account cache before scan
[2025-03-21 13:34:32] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 13:34:32] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 13:34:32] [INFO] [main] Creating test accounts for scan
[2025-03-21 13:34:32] [WARNING] [main] Failed to create test account: test1742582072@example.com, status: 404
[2025-03-21 13:34:32] [WARNING] [main] Failed to create test account: test1742582073@example.com, status: 404
[2025-03-21 13:34:32] [WARNING] [main] Failed to create test account: test1742582074@example.com, status: 404
[2025-03-21 13:34:32] [INFO] [orchestrator] Starting API security scan
[2025-03-21 13:34:32] [INFO] [orchestrator] Loading configuration from configs/vampi.yaml
[2025-03-21 13:34:32] [ERROR] [config] Configuration file not found: configs/vampi.yaml
[2025-03-21 13:34:32] [CRITICAL] [orchestrator] Failed to load configuration: Configuration file not found: configs/vampi.yaml
[2025-03-21 13:34:32] [CRITICAL] [orchestrator] Scan failed: Configuration error: Configuration file not found: configs/vampi.yaml
[2025-03-21 13:40:38] [INFO] [main] Clearing account cache before scan
[2025-03-21 13:40:38] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 13:40:38] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 13:40:38] [INFO] [main] Creating test accounts for scan
[2025-03-21 13:40:38] [WARNING] [main] Failed to create test account: test1742582438@example.com, status: 404
[2025-03-21 13:40:38] [WARNING] [main] Failed to create test account: test1742582439@example.com, status: 404
[2025-03-21 13:40:38] [WARNING] [main] Failed to create test account: test1742582440@example.com, status: 404
[2025-03-21 13:40:38] [INFO] [orchestrator] Starting API security scan
[2025-03-21 13:40:38] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 13:40:38] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 13:40:38] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 13:40:38] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 13:40:38] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 13:40:38] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 13:40:38] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 13:40:38] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 13:40:38] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 13:40:38] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 13:40:38] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 13:40:38] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 13:40:38] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 13:40:38] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 13:40:38] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:38] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 13:40:38] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:40:38] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 13:40:38] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 13:40:38] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:40:38] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 13:40:38] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:40:39] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 13:40:39] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 13:40:39] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 13:40:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:40:39] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 13:40:39] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 13:40:39] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 13:40:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:40:39] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 13:40:39] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 13:40:39] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 13:40:39] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 13:40:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:40:39] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 13:40:39] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 13:40:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:40:39] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 13:40:39] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 13:40:39] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 13:40:39] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 13:40:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 13:40:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:40:39] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 13:40:39] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 13:40:39] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:40:39] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 13:40:39] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 13:40:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:39] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 13:40:39] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 13:40:39] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 13:40:39] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 13:40:39] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 13:40:39] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 13:40:39] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 13:40:39] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 13:40:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:39] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 13:40:39] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 13:40:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:40:39] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 13:40:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:40:39] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 13:40:39] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 13:40:39] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 13:40:39] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 13:40:39] [INFO] [core.account_cache] Added new account to cache: test_user_1742582439_1
[2025-03-21 13:40:39] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 13:40:39] [INFO] [orchestrator] Added test account to cache: test_user_1742582439_1
[2025-03-21 13:40:39] [INFO] [core.account_cache] Added new account to cache: test_user_1742582439_2
[2025-03-21 13:40:39] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 13:40:39] [INFO] [orchestrator] Added test account to cache: test_user_1742582439_2
[2025-03-21 13:40:39] [INFO] [core.account_cache] Added new account to cache: test_user_1742582439_3
[2025-03-21 13:40:39] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:40:39] [INFO] [orchestrator] Added test account to cache: test_user_1742582439_3
[2025-03-21 13:40:39] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 13:40:39] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 13:40:39] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 13:40:39] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 13:40:39] [INFO] [Scanner] Found 8 users in debug endpoint response
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 13:40:39] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 13:40:39] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 13:40:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 13:40:39] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 13:40:39] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 13:40:39] [INFO] [core.account_cache] Using cached account: test_user_1742582439_1
[2025-03-21 13:40:39] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:40:39] [INFO] [Scanner] Using cached account: test_user_1742582439_1
[2025-03-21 13:40:39] [INFO] [Scanner] Using existing test account: test_user_1742582439_1
[2025-03-21 13:40:39] [INFO] [Scanner] Logging in as user 'test_user_1742582439_1'
[2025-03-21 13:40:39] [INFO] [Scanner] Login payload: {"email": "test_user_1742582439_1", "password": "Test@1742582439_1"}
[2025-03-21 13:40:39] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 13:40:39] [WARNING] [Scanner] Failed to login as 'test_user_1742582439_1', status code: 400
[2025-03-21 13:40:39] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 13:40:39] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 13:40:39] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.06 seconds
[2025-03-21 13:40:39] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 13:40:39] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 13:40:39] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:40:39] [INFO] [Scanner] Found 8 existing accounts
[2025-03-21 13:40:39] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 13:40:39] [INFO] [Scanner] Registering user 'admin_user_1742582439_yr1fb4@example.com' with admin=True
[2025-03-21 13:40:39] [INFO] [Scanner] Successfully registered user 'admin_user_1742582439_yr1fb4@example.com'
[2025-03-21 13:40:40] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:40:40] [INFO] [Scanner] Found 9 existing accounts
[2025-03-21 13:40:40] [WARNING] [Scanner] User 'admin_user_1742582439_yr1fb4@example.com' was created with admin privileges
[2025-03-21 13:40:40] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 13:40:40] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 13:40:40] [INFO] [core.account_cache] Using cached account: test_user_1742582439_2
[2025-03-21 13:40:40] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:40:40] [INFO] [Scanner] Using cached account: test_user_1742582439_2
[2025-03-21 13:40:41] [INFO] [Scanner] Logging in as user 'test_user_1742582439_yr1fb4@example.com'
[2025-03-21 13:40:41] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 13:40:41] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 13:40:41] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 13:40:41] [INFO] [core.account_cache] Using cached account: test_user_1742582439_3
[2025-03-21 13:40:41] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:40:41] [INFO] [Scanner] Using cached account: test_user_1742582439_3
[2025-03-21 13:40:42] [INFO] [Scanner] Logging in as user 'test_user_1742582439_yr1fb4@example.com'
[2025-03-21 13:40:42] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 13:40:42] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 13:40:42] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 13:40:42] [INFO] [core.account_cache] Using cached account: test_user_1742582439_1
[2025-03-21 13:40:42] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:40:42] [INFO] [Scanner] Using cached account: test_user_1742582439_1
[2025-03-21 13:40:42] [INFO] [Scanner] Logging in as user 'test_user_1742582439_yr1fb4@example.com'
[2025-03-21 13:40:42] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 13:40:42] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 13:40:42] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.06 seconds
[2025-03-21 13:40:42] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 13:40:42] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 13:40:42] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 13:40:42] [INFO] [Scanner] Debug endpoint returned a 'users' array with 9 items
[2025-03-21 13:40:42] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 13:40:42] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321134042.json
[2025-03-21 13:40:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 13:40:42] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 13:40:42] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 13:40:42] [INFO] [Scanner] Registering test user: test_user_1742582439_9qqx2p
[2025-03-21 13:40:42] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 13:40:42] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 13:40:42] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 13:40:42] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 13:40:42] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 13:40:42] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 13:40:42] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 13:40:42] [INFO] [Scanner] Using email as user identifier
[2025-03-21 13:40:50] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 13:40:50] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 13:40:50] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 13:40:50] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 13:40:51] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 13:40:51] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 13:40:52] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 13:40:52] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 13:40:52] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 13:40:53] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 13:40:53] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 13:40:53] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742582453' with admin privileges
[2025-03-21 13:40:53] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742582453'
[2025-03-21 13:40:54] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 13:40:54] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.82 seconds
[2025-03-21 13:40:54] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 13:40:54] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 13:40:54] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 13:40:54] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:40:54] [INFO] [Scanner] Found 12 existing accounts
[2025-03-21 13:40:55] [INFO] [Scanner] Registering new test user 'test_user_1742582439_arp93z' with admin privileges
[2025-03-21 13:40:55] [INFO] [Scanner] Successfully registered test user 'test_user_1742582439_arp93z'
[2025-03-21 13:40:55] [INFO] [Scanner] Verifying test user 'test_user_1742582439_arp93z' was created
[2025-03-21 13:40:56] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:40:56] [INFO] [Scanner] Found 13 existing accounts
[2025-03-21 13:40:56] [INFO] [Scanner] Verified test user 'test_user_1742582439_arp93z' was created successfully
[2025-03-21 13:40:56] [INFO] [Scanner] Logging in as test user 'test_user_1742582439_arp93z'
[2025-03-21 13:40:56] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 13:40:56] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 13:40:56] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 13:40:56] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 13:40:56] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 13:40:56] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 13:40:56] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.06 seconds
[2025-03-21 13:40:56] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 13:40:56] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 13:40:56] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 13:40:56] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742582456_standard_9tmb@example.com
[2025-03-21 13:40:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:40:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:40:56] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742582456_standard_9tmb@example.com, status code: 404
[2025-03-21 13:40:57] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742582456_premium_02qa@example.com
[2025-03-21 13:40:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:40:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:40:57] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742582456_premium_02qa@example.com, status code: 404
[2025-03-21 13:40:58] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742582456_admin_rm5n@example.com
[2025-03-21 13:40:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:40:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:40:58] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742582456_admin_rm5n@example.com, status code: 404
[2025-03-21 13:40:59] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 13:40:59] [INFO] [Scanner] Testing basic account creation
[2025-03-21 13:40:59] [INFO] [core.account_cache] Using cached account: test_user_1742582439_2
[2025-03-21 13:40:59] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:40:59] [INFO] [Scanner] Using cached account: test_user_1742582439_2
[2025-03-21 13:40:59] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 13:40:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:40:59] [WARNING] [Scanner] Failed to create test account: test_user_1742582439_2, status code: 404
[2025-03-21 13:40:59] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 13:40:59] [INFO] [Scanner] Testing: Empty username
[2025-03-21 13:40:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:40:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:40:59] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 13:40:59] [INFO] [Scanner] Testing: Very short username
[2025-03-21 13:40:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:40:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:40:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:40:59] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 13:41:00] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 13:41:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:00] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 13:41:00] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 13:41:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:00] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 13:41:01] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 13:41:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:01] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 13:41:01] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 13:41:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:01] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 13:41:02] [INFO] [Scanner] Testing: Empty email
[2025-03-21 13:41:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:02] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 13:41:02] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 13:41:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:02] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 13:41:03] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 13:41:03] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:03] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:03] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:03] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 13:41:03] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 13:41:03] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:03] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:03] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:03] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 13:41:04] [INFO] [Scanner] Testing: Empty password
[2025-03-21 13:41:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:04] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 13:41:04] [INFO] [Scanner] Testing: Short password
[2025-03-21 13:41:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:04] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 13:41:05] [INFO] [Scanner] Testing: Common password
[2025-03-21 13:41:05] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:05] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:05] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:05] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 13:41:05] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 13:41:05] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:05] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:05] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:05] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 13:41:06] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 13:41:06] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 13:41:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:06] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 13:41:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:06] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 13:41:07] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:07] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:07] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:07] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 13:41:07] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:41:07] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 13:41:07] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 13:41:07] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 13:41:07] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 13:41:10] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:10] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:10] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:10] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:41:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:11] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:41:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:12] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:41:12] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:41:12] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 13:41:12] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 13:41:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:15] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:41:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:21] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:41:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:27] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:41:27] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:41:27] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 13:41:27] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 13:41:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:30] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:41:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:39] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:41:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:47] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:41:47] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:41:47] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 13:41:47] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 13:41:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:50] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:41:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:41:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:41:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:41:59] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:42:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:08] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:42:08] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:42:08] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 13:42:08] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 13:42:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:11] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:42:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:21] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:42:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:32] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:42:32] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:42:32] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 13:42:32] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 13:42:32] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 13:42:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:32] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 13:42:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:41] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 13:42:52] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:42:52] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 13:42:52] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 13:42:52] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 13:42:52] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 13:42:52] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 13:42:52] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 13:42:52] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 13:42:52] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 13:42:52] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 13:42:52] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 13:42:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:42:52] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 13:42:52] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 13:42:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:42:52] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 13:42:52] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 13:42:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:42:52] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 13:42:52] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:42:52] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 13:42:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:42:52] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 13:42:52] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 13:42:52] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 13:42:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:42:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:42:52] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 13:42:52] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 13:42:52] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 116.38 seconds
[2025-03-21 13:42:52] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 13:42:52] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 13:42:52] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 13:42:52] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 13:42:52] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 13:42:52] [INFO] [Scanner] User info endpoint: /
[2025-03-21 13:42:52] [INFO] [Scanner] Debug mode: True
[2025-03-21 13:42:52] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 13:42:52] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 13:42:52] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 13:42:52] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4MjU3MiwiZXhwIjoxNzQ1MTc0NTcyfQ.RB9ahNrAAnLcFkW6ybQC8MJhHhthXZ__h1YETMXcTKk
[2025-03-21 13:42:52] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 13:42:52] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 13:42:52] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 13:42:52] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 13:42:52] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 13:42:52] [INFO] [Scanner] JWT Expiration: 2025-04-20 13:42:52 (in 720.0 hours)
[2025-03-21 13:42:52] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 13:42:52] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 13:42:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 13:42:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 13:42:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 13:42:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 13:42:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 13:42:52] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 13:42:52] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 13:42:52] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 13:42:52] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 13:42:52] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 13:42:52] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 13:42:52] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 13:42:52] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 13:42:52] [INFO] [utils] Results saved to results/20250321134252.json
[2025-03-21 13:42:52] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 13:54:29] [INFO] [main] Clearing account cache before scan
[2025-03-21 13:54:29] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 13:54:29] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 13:54:29] [INFO] [main] Creating test accounts for scan
[2025-03-21 13:54:29] [WARNING] [main] Failed to create test account: test1742583269@example.com, status: 404
[2025-03-21 13:54:29] [WARNING] [main] Failed to create test account: test1742583270@example.com, status: 404
[2025-03-21 13:54:29] [WARNING] [main] Failed to create test account: test1742583271@example.com, status: 404
[2025-03-21 13:54:29] [INFO] [orchestrator] Starting API security scan
[2025-03-21 13:54:29] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 13:54:29] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 13:54:29] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 13:54:29] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 13:54:29] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 13:54:29] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 13:54:29] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 13:54:29] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 13:54:29] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 13:54:29] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 13:54:29] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 13:54:29] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:54:29] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 13:54:29] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:54:29] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 13:54:29] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 13:54:29] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 13:54:29] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:54:29] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 13:54:29] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:54:29] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 13:54:29] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 13:54:29] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 13:54:29] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 13:54:29] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:54:29] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:54:29] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 13:54:29] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 13:54:29] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 13:54:29] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 13:54:29] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 13:54:29] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 13:54:29] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:54:29] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 13:54:29] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 13:54:29] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 13:54:29] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 13:54:29] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 13:54:29] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 13:54:29] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 13:54:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:29] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 13:54:29] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 13:54:29] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 13:54:29] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 13:54:29] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 13:54:29] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 13:54:29] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 13:54:29] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 13:54:29] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 13:54:29] [INFO] [core.account_cache] Added new account to cache: test_user_1742583269_1
[2025-03-21 13:54:29] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 13:54:29] [INFO] [orchestrator] Added test account to cache: test_user_1742583269_1
[2025-03-21 13:54:29] [INFO] [core.account_cache] Added new account to cache: test_user_1742583269_2
[2025-03-21 13:54:29] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 13:54:29] [INFO] [orchestrator] Added test account to cache: test_user_1742583269_2
[2025-03-21 13:54:29] [INFO] [core.account_cache] Added new account to cache: test_user_1742583269_3
[2025-03-21 13:54:29] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:54:29] [INFO] [orchestrator] Added test account to cache: test_user_1742583269_3
[2025-03-21 13:54:29] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 13:54:29] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 13:54:29] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 13:54:29] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 13:54:29] [INFO] [Scanner] Found 13 users in debug endpoint response
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 13:54:29] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 13:54:29] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 13:54:29] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 13:54:29] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 13:54:29] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 13:54:29] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 13:54:29] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 13:54:29] [INFO] [core.account_cache] Using cached account: test_user_1742583269_1
[2025-03-21 13:54:29] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:54:29] [INFO] [Scanner] Using cached account: test_user_1742583269_1
[2025-03-21 13:54:29] [INFO] [Scanner] Using existing test account: test_user_1742583269_1
[2025-03-21 13:54:29] [INFO] [Scanner] Logging in as user 'test_user_1742583269_1'
[2025-03-21 13:54:29] [INFO] [Scanner] Login payload: {"email": "test_user_1742583269_1", "password": "Test@1742583269_1"}
[2025-03-21 13:54:29] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 13:54:29] [WARNING] [Scanner] Failed to login as 'test_user_1742583269_1', status code: 400
[2025-03-21 13:54:29] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 13:54:29] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 13:54:29] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.10 seconds
[2025-03-21 13:54:29] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 13:54:29] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 13:54:29] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:54:29] [INFO] [Scanner] Found 13 existing accounts
[2025-03-21 13:54:29] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 13:54:29] [INFO] [Scanner] Registering user 'admin_user_1742583269_2176iq@example.com' with admin=True
[2025-03-21 13:54:29] [INFO] [Scanner] Successfully registered user 'admin_user_1742583269_2176iq@example.com'
[2025-03-21 13:54:30] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:54:30] [INFO] [Scanner] Found 14 existing accounts
[2025-03-21 13:54:30] [WARNING] [Scanner] User 'admin_user_1742583269_2176iq@example.com' was created with admin privileges
[2025-03-21 13:54:30] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 13:54:30] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 13:54:30] [INFO] [core.account_cache] Using cached account: test_user_1742583269_2
[2025-03-21 13:54:30] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:54:30] [INFO] [Scanner] Using cached account: test_user_1742583269_2
[2025-03-21 13:54:31] [INFO] [Scanner] Logging in as user 'test_user_1742583269_2176iq@example.com'
[2025-03-21 13:54:31] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 13:54:31] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 13:54:31] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 13:54:31] [INFO] [core.account_cache] Using cached account: test_user_1742583269_3
[2025-03-21 13:54:31] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:54:31] [INFO] [Scanner] Using cached account: test_user_1742583269_3
[2025-03-21 13:54:32] [INFO] [Scanner] Logging in as user 'test_user_1742583269_2176iq@example.com'
[2025-03-21 13:54:32] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 13:54:32] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 13:54:32] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 13:54:32] [INFO] [core.account_cache] Using cached account: test_user_1742583269_1
[2025-03-21 13:54:32] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:54:32] [INFO] [Scanner] Using cached account: test_user_1742583269_1
[2025-03-21 13:54:32] [INFO] [Scanner] Logging in as user 'test_user_1742583269_2176iq@example.com'
[2025-03-21 13:54:32] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 13:54:32] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 13:54:32] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.07 seconds
[2025-03-21 13:54:32] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 13:54:32] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 13:54:32] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 13:54:32] [INFO] [Scanner] Debug endpoint returned a 'users' array with 14 items
[2025-03-21 13:54:32] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 13:54:32] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321135432.json
[2025-03-21 13:54:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 13:54:32] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 13:54:32] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 13:54:32] [INFO] [Scanner] Registering test user: test_user_1742583269_lyh12f
[2025-03-21 13:54:32] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 13:54:32] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 13:54:32] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 13:54:32] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 13:54:32] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 13:54:32] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 13:54:32] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 13:54:32] [INFO] [Scanner] Using email as user identifier
[2025-03-21 13:54:41] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 13:54:41] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 13:54:41] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 13:54:41] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 13:54:41] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 13:54:42] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 13:54:42] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 13:54:42] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 13:54:43] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 13:54:43] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 13:54:44] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 13:54:44] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742583284' with admin privileges
[2025-03-21 13:54:44] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742583284'
[2025-03-21 13:54:45] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 13:54:45] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.80 seconds
[2025-03-21 13:54:45] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 13:54:45] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 13:54:45] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 13:54:45] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:54:45] [INFO] [Scanner] Found 17 existing accounts
[2025-03-21 13:54:45] [INFO] [Scanner] Registering new test user 'test_user_1742583269_cndaj7' with admin privileges
[2025-03-21 13:54:45] [INFO] [Scanner] Successfully registered test user 'test_user_1742583269_cndaj7'
[2025-03-21 13:54:45] [INFO] [Scanner] Verifying test user 'test_user_1742583269_cndaj7' was created
[2025-03-21 13:54:46] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 13:54:46] [INFO] [Scanner] Found 18 existing accounts
[2025-03-21 13:54:46] [INFO] [Scanner] Verified test user 'test_user_1742583269_cndaj7' was created successfully
[2025-03-21 13:54:46] [INFO] [Scanner] Logging in as test user 'test_user_1742583269_cndaj7'
[2025-03-21 13:54:46] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 13:54:46] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 13:54:46] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 13:54:46] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 13:54:46] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 13:54:46] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 13:54:46] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.06 seconds
[2025-03-21 13:54:46] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 13:54:46] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 13:54:46] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 13:54:46] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742583286_standard_az07@example.com
[2025-03-21 13:54:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:46] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742583286_standard_az07@example.com, status code: 404
[2025-03-21 13:54:47] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742583286_premium_fpis@example.com
[2025-03-21 13:54:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:47] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742583286_premium_fpis@example.com, status code: 404
[2025-03-21 13:54:48] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742583286_admin_pbn7@example.com
[2025-03-21 13:54:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:48] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742583286_admin_pbn7@example.com, status code: 404
[2025-03-21 13:54:49] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 13:54:49] [INFO] [Scanner] Testing basic account creation
[2025-03-21 13:54:49] [INFO] [core.account_cache] Using cached account: test_user_1742583269_2
[2025-03-21 13:54:49] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 13:54:49] [INFO] [Scanner] Using cached account: test_user_1742583269_2
[2025-03-21 13:54:49] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 13:54:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:49] [WARNING] [Scanner] Failed to create test account: test_user_1742583269_2, status code: 404
[2025-03-21 13:54:49] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 13:54:49] [INFO] [Scanner] Testing: Empty username
[2025-03-21 13:54:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:49] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 13:54:49] [INFO] [Scanner] Testing: Very short username
[2025-03-21 13:54:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:49] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 13:54:50] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 13:54:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:50] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 13:54:50] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 13:54:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:50] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 13:54:51] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 13:54:51] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:51] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:51] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:51] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 13:54:51] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 13:54:51] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:51] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:51] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:51] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 13:54:52] [INFO] [Scanner] Testing: Empty email
[2025-03-21 13:54:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:52] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 13:54:52] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 13:54:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:52] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 13:54:53] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 13:54:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:53] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 13:54:53] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 13:54:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:53] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 13:54:54] [INFO] [Scanner] Testing: Empty password
[2025-03-21 13:54:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:54] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 13:54:54] [INFO] [Scanner] Testing: Short password
[2025-03-21 13:54:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:54] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 13:54:55] [INFO] [Scanner] Testing: Common password
[2025-03-21 13:54:55] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:55] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:55] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:55] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 13:54:55] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 13:54:55] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:55] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:55] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:55] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 13:54:56] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 13:54:56] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 13:54:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:56] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 13:54:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:56] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 13:54:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:54:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:54:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:54:57] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 13:54:57] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:54:57] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 13:54:57] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 13:54:57] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 13:54:57] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 13:55:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:00] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:55:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:01] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:55:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:02] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:55:02] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:55:02] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 13:55:02] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 13:55:05] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:05] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:05] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:05] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:55:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:11] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:55:17] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:17] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:17] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:17] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:55:17] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:55:17] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 13:55:17] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 13:55:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:20] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:55:28] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:28] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:28] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:28] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:55:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:35] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:55:35] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:55:35] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 13:55:35] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 13:55:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:38] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:55:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:47] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:55:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:56] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:55:56] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:55:56] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 13:55:56] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 13:55:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:55:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:55:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:55:59] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 13:56:09] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:09] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:09] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 13:56:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:19] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 13:56:19] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:56:19] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 13:56:19] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 13:56:19] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 13:56:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:19] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 13:56:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:30] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 13:56:40] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 13:56:40] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 13:56:40] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 13:56:40] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 13:56:40] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 13:56:40] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 13:56:40] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 13:56:40] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 13:56:40] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 13:56:40] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 13:56:40] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 13:56:40] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:56:40] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 13:56:40] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 13:56:40] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:56:40] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 13:56:40] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 13:56:40] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:56:40] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 13:56:40] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] No token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 13:56:40] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 13:56:40] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 13:56:40] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 13:56:40] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 13:56:40] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 13:56:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 13:56:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 13:56:40] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 13:56:40] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 13:56:40] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 113.95 seconds
[2025-03-21 13:56:40] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 13:56:40] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 13:56:40] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 13:56:40] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 13:56:40] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 13:56:40] [INFO] [Scanner] User info endpoint: /
[2025-03-21 13:56:40] [INFO] [Scanner] Debug mode: True
[2025-03-21 13:56:40] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 13:56:40] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 13:56:40] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 13:56:40] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4MzQwMCwiZXhwIjoxNzQ1MTc1NDAwfQ.8Yy1DL8d0sF74nABk_sM7F_fqzwiZMfubRU5k-Kdfho
[2025-03-21 13:56:40] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 13:56:40] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 13:56:40] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 13:56:40] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 13:56:40] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 13:56:40] [INFO] [Scanner] JWT Expiration: 2025-04-20 13:56:40 (in 720.0 hours)
[2025-03-21 13:56:40] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 13:56:40] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 13:56:40] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 13:56:40] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 13:56:40] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 13:56:40] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 13:56:40] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 13:56:40] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 13:56:40] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 13:56:40] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 13:56:40] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 13:56:40] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 13:56:40] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 13:56:40] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 13:56:40] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 13:56:40] [INFO] [utils] Results saved to results/20250321135640.json
[2025-03-21 13:56:40] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:02:39] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:02:39] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:02:39] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:02:39] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:02:39] [WARNING] [main] Failed to create test account: test1742583759@example.com, status: 404
[2025-03-21 14:02:39] [WARNING] [main] Failed to create test account: test1742583760@example.com, status: 404
[2025-03-21 14:02:39] [WARNING] [main] Failed to create test account: test1742583761@example.com, status: 404
[2025-03-21 14:02:39] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:02:39] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vmapi.yaml
[2025-03-21 14:02:39] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:02:39] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:02:39] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:02:39] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:02:39] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:02:39] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:02:39] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:02:39] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:02:39] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:02:39] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:02:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:02:39] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:02:39] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:02:39] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:02:39] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:02:39] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:02:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:02:39] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:02:39] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:02:39] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:02:39] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:02:39] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:02:39] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:02:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:02:39] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:02:39] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:02:39] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:02:39] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:02:39] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:02:39] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:02:39] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:02:39] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:02:39] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:02:39] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:02:39] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:02:39] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:02:39] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:02:39] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:02:39] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:02:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:39] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:02:39] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:02:39] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:02:39] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:02:39] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:02:39] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:02:39] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:02:39] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:02:39] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:02:39] [INFO] [core.account_cache] Added new account to cache: test_user_1742583759_1
[2025-03-21 14:02:39] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:02:39] [INFO] [orchestrator] Added test account to cache: test_user_1742583759_1
[2025-03-21 14:02:39] [INFO] [core.account_cache] Added new account to cache: test_user_1742583759_2
[2025-03-21 14:02:39] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:02:39] [INFO] [orchestrator] Added test account to cache: test_user_1742583759_2
[2025-03-21 14:02:39] [INFO] [core.account_cache] Added new account to cache: test_user_1742583759_3
[2025-03-21 14:02:39] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:02:39] [INFO] [orchestrator] Added test account to cache: test_user_1742583759_3
[2025-03-21 14:02:39] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:02:39] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:02:39] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:02:39] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Found 18 users in debug endpoint response
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:02:39] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:02:39] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:02:39] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:02:39] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:02:39] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:02:39] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:02:39] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:02:39] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:02:39] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:02:39] [INFO] [core.account_cache] Using cached account: test_user_1742583759_1
[2025-03-21 14:02:39] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:02:39] [INFO] [Scanner] Using cached account: test_user_1742583759_1
[2025-03-21 14:02:39] [INFO] [Scanner] Using existing test account: test_user_1742583759_1
[2025-03-21 14:02:39] [INFO] [Scanner] Logging in as user 'test_user_1742583759_1'
[2025-03-21 14:02:39] [INFO] [Scanner] Login payload: {"email": "test_user_1742583759_1", "password": "Test@1742583759_1"}
[2025-03-21 14:02:39] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:02:39] [WARNING] [Scanner] Failed to login as 'test_user_1742583759_1', status code: 400
[2025-03-21 14:02:39] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:02:39] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:02:39] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.15 seconds
[2025-03-21 14:02:39] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:02:39] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:02:39] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:02:39] [INFO] [Scanner] Found 18 existing accounts
[2025-03-21 14:02:39] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:02:39] [INFO] [Scanner] Registering user 'admin_user_1742583759_2xvv2y@example.com' with admin=True
[2025-03-21 14:02:39] [INFO] [Scanner] Successfully registered user 'admin_user_1742583759_2xvv2y@example.com'
[2025-03-21 14:02:40] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:02:40] [INFO] [Scanner] Found 19 existing accounts
[2025-03-21 14:02:40] [WARNING] [Scanner] User 'admin_user_1742583759_2xvv2y@example.com' was created with admin privileges
[2025-03-21 14:02:40] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:02:40] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:02:40] [INFO] [core.account_cache] Using cached account: test_user_1742583759_2
[2025-03-21 14:02:40] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:02:40] [INFO] [Scanner] Using cached account: test_user_1742583759_2
[2025-03-21 14:02:41] [INFO] [Scanner] Logging in as user 'test_user_1742583759_2xvv2y@example.com'
[2025-03-21 14:02:41] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:02:41] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:02:41] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:02:41] [INFO] [core.account_cache] Using cached account: test_user_1742583759_3
[2025-03-21 14:02:41] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:02:41] [INFO] [Scanner] Using cached account: test_user_1742583759_3
[2025-03-21 14:02:42] [INFO] [Scanner] Logging in as user 'test_user_1742583759_2xvv2y@example.com'
[2025-03-21 14:02:42] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:02:42] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:02:42] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:02:42] [INFO] [core.account_cache] Using cached account: test_user_1742583759_1
[2025-03-21 14:02:42] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:02:42] [INFO] [Scanner] Using cached account: test_user_1742583759_1
[2025-03-21 14:02:42] [INFO] [Scanner] Logging in as user 'test_user_1742583759_2xvv2y@example.com'
[2025-03-21 14:02:42] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:02:42] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:02:42] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.07 seconds
[2025-03-21 14:02:42] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:02:42] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:02:42] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:02:42] [INFO] [Scanner] Debug endpoint returned a 'users' array with 19 items
[2025-03-21 14:02:42] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:02:42] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321140242.json
[2025-03-21 14:02:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:02:42] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:02:42] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:02:42] [INFO] [Scanner] Registering test user: test_user_1742583759_pbimoj
[2025-03-21 14:02:42] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:02:42] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:02:42] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:02:42] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:02:42] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:02:42] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:02:42] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:02:42] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:02:51] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:02:51] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:02:51] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:02:51] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:02:51] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:02:52] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:02:52] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:02:52] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:02:53] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:02:53] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:02:54] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:02:54] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742583774' with admin privileges
[2025-03-21 14:02:54] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742583774'
[2025-03-21 14:02:55] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:02:55] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.77 seconds
[2025-03-21 14:02:55] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:02:55] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:02:55] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:02:55] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:02:55] [INFO] [Scanner] Found 22 existing accounts
[2025-03-21 14:02:55] [INFO] [Scanner] Registering new test user 'test_user_1742583759_i1pcuz' with admin privileges
[2025-03-21 14:02:55] [INFO] [Scanner] Successfully registered test user 'test_user_1742583759_i1pcuz'
[2025-03-21 14:02:55] [INFO] [Scanner] Verifying test user 'test_user_1742583759_i1pcuz' was created
[2025-03-21 14:02:56] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:02:56] [INFO] [Scanner] Found 23 existing accounts
[2025-03-21 14:02:56] [INFO] [Scanner] Verified test user 'test_user_1742583759_i1pcuz' was created successfully
[2025-03-21 14:02:56] [INFO] [Scanner] Logging in as test user 'test_user_1742583759_i1pcuz'
[2025-03-21 14:02:56] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:02:56] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:02:56] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:02:56] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:02:56] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:02:56] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:02:56] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.05 seconds
[2025-03-21 14:02:56] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:02:56] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:02:56] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:02:56] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742583776_standard_s5v9@example.com
[2025-03-21 14:02:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:02:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:02:56] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742583776_standard_s5v9@example.com, status code: 404
[2025-03-21 14:02:57] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742583776_premium_jc0p@example.com
[2025-03-21 14:02:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:02:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:02:57] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742583776_premium_jc0p@example.com, status code: 404
[2025-03-21 14:02:58] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742583776_admin_j0az@example.com
[2025-03-21 14:02:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:02:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:02:58] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742583776_admin_j0az@example.com, status code: 404
[2025-03-21 14:02:59] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:02:59] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:02:59] [INFO] [core.account_cache] Using cached account: test_user_1742583759_2
[2025-03-21 14:02:59] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:02:59] [INFO] [Scanner] Using cached account: test_user_1742583759_2
[2025-03-21 14:02:59] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:02:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:02:59] [WARNING] [Scanner] Failed to create test account: test_user_1742583759_2, status code: 404
[2025-03-21 14:02:59] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:02:59] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:02:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:02:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:02:59] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:02:59] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:02:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:02:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:02:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:02:59] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:03:00] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:03:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:00] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:03:00] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:03:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:00] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:03:01] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:03:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:01] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:03:01] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:03:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:01] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:03:02] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:03:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:02] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:03:02] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:03:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:02] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:03:03] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:03:03] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:03] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:03] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:03] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:03:03] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:03:03] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:03] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:03] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:03] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:03:04] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:03:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:04] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:03:04] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:03:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:04] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:03:05] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:03:05] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:05] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:05] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:05] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:03:05] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:03:05] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:05] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:05] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:05] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:03:06] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:03:06] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:03:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:06] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:03:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:06] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:03:07] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:07] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:07] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:07] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:03:07] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:03:07] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:03:07] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:03:07] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:03:07] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:03:10] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:10] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:10] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:10] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:03:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:11] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:03:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:12] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:03:12] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:03:12] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:03:12] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:03:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:15] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:03:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:21] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:03:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:26] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:03:26] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:03:26] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:03:26] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:03:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:29] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:03:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:38] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:03:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:46] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:03:46] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:03:46] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:03:46] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:03:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:49] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:03:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:03:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:03:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:03:59] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:04:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:08] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:04:08] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:04:08] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:04:08] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:04:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:11] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:04:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:22] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:04:31] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:31] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:31] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:31] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:04:31] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:04:31] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:04:31] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:04:31] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:04:31] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:31] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:31] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:31] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:04:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:41] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:04:52] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:04:52] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:04:52] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:04:52] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:04:52] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:04:52] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:04:52] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:04:52] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:04:52] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:04:52] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:04:52] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:04:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:04:52] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:04:52] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:04:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:04:52] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:04:52] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:04:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:04:52] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:04:52] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:04:52] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:04:52] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:04:52] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:04:52] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:04:52] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:04:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:04:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:04:52] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:04:52] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:04:52] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 115.87 seconds
[2025-03-21 14:04:52] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:04:52] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:04:52] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:04:52] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:04:52] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:04:52] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:04:52] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:04:52] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:04:52] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:04:52] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:04:52] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4Mzg5MiwiZXhwIjoxNzQ1MTc1ODkyfQ.hqm-vgk8w3jrmTRlPyOmJm-zEBPf8By4qVzU4u6IIUc
[2025-03-21 14:04:52] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:04:52] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:04:52] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:04:52] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:04:52] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:04:52] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:04:52 (in 720.0 hours)
[2025-03-21 14:04:52] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:04:52] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:04:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:04:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:04:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:04:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:04:52] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:04:52] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:04:52] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:04:52] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:04:52] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:04:52] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:04:52] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:04:52] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:04:52] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:04:52] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:04:52] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321140452.json
[2025-03-21 14:04:52] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:08:13] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:08:13] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:08:13] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:08:13] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:08:13] [WARNING] [main] Failed to create test account: test1742584093@example.com, status: 404
[2025-03-21 14:08:13] [WARNING] [main] Failed to create test account: test1742584094@example.com, status: 404
[2025-03-21 14:08:13] [WARNING] [main] Failed to create test account: test1742584095@example.com, status: 404
[2025-03-21 14:08:13] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:08:13] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:08:13] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:08:13] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:08:13] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:08:13] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:08:13] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:08:13] [INFO] [orchestrator] Applying URL override: http://localhost:3000
[2025-03-21 14:08:13] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:08:13] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:08:13] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:08:13] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:08:13] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:08:13] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:08:13] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:08:13] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:08:13] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:08:13] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:08:13] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:08:13] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:08:13] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:08:13] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:08:13] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:08:13] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:08:13] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:08:13] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:08:13] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:08:13] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:08:13] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:08:13] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:08:13] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:08:13] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:08:13] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:08:13] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:08:13] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:08:13] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:08:13] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:08:13] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:08:13] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:08:13] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:08:13] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:08:13] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:08:13] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:08:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:13] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:08:13] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:08:13] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:08:13] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:08:13] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:08:13] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:08:13] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:08:13] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:08:13] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:08:13] [INFO] [core.account_cache] Added new account to cache: test_user_1742584093_1
[2025-03-21 14:08:13] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:08:13] [INFO] [orchestrator] Added test account to cache: test_user_1742584093_1
[2025-03-21 14:08:13] [INFO] [core.account_cache] Added new account to cache: test_user_1742584093_2
[2025-03-21 14:08:13] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:08:13] [INFO] [orchestrator] Added test account to cache: test_user_1742584093_2
[2025-03-21 14:08:13] [INFO] [core.account_cache] Added new account to cache: test_user_1742584093_3
[2025-03-21 14:08:13] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:08:13] [INFO] [orchestrator] Added test account to cache: test_user_1742584093_3
[2025-03-21 14:08:13] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:08:13] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:08:13] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:08:13] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:08:13] [INFO] [Scanner] Debug endpoint not accessible, status code: 404
[2025-03-21 14:08:13] [INFO] [core.account_cache] Using cached account: test_user_1742584093_1
[2025-03-21 14:08:13] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:08:13] [INFO] [Scanner] Using cached account: test_user_1742584093_1
[2025-03-21 14:08:13] [INFO] [Scanner] Using existing test account: test_user_1742584093_1
[2025-03-21 14:08:13] [INFO] [Scanner] Logging in as user 'test_user_1742584093_1'
[2025-03-21 14:08:13] [INFO] [Scanner] Login payload: {"email": "test_user_1742584093_1", "password": "Test@1742584093_1"}
[2025-03-21 14:08:13] [INFO] [Scanner] Login response: 404 - <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error</title>
</head>
<body>
<pre>Cannot POST /users/v1/login</pre>
</body>
</html>

[2025-03-21 14:08:13] [WARNING] [Scanner] Failed to login as 'test_user_1742584093_1', status code: 404
[2025-03-21 14:08:13] [WARNING] [Scanner] Response body: <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error</title>
</head>
<body>
<pre>Cannot POST /users/v1/login</pre>
</body>
</html>

[2025-03-21 14:08:13] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:08:13] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.01 seconds
[2025-03-21 14:08:13] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:08:13] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:08:13] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:08:14] [WARNING] [Scanner] Failed to retrieve existing accounts, status code: 404
[2025-03-21 14:08:14] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:08:14] [INFO] [Scanner] Registering user 'admin_user_1742584093_3d3axl@example.com' with admin=True
[2025-03-21 14:08:14] [WARNING] [Scanner] Failed to register user 'admin_user_1742584093_3d3axl@example.com', status code: 404
[2025-03-21 14:08:14] [INFO] [Scanner] Failed to register user with admin privileges, skipping test
[2025-03-21 14:08:14] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:08:14] [INFO] [core.account_cache] Using cached account: test_user_1742584093_2
[2025-03-21 14:08:14] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:08:14] [INFO] [Scanner] Using cached account: test_user_1742584093_2
[2025-03-21 14:08:15] [INFO] [Scanner] Logging in as user 'test_user_1742584093_3d3axl@example.com'
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to login as 'test_user_1742584093_3d3axl@example.com', status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:08:15] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:08:15] [INFO] [Scanner] No existing users found, skipping test
[2025-03-21 14:08:15] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:08:15] [INFO] [core.account_cache] Using cached account: test_user_1742584093_3
[2025-03-21 14:08:15] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:08:15] [INFO] [Scanner] Using cached account: test_user_1742584093_3
[2025-03-21 14:08:15] [INFO] [Scanner] Logging in as user 'test_user_1742584093_3d3axl@example.com'
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to login as 'test_user_1742584093_3d3axl@example.com', status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:08:15] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 1.01 seconds
[2025-03-21 14:08:15] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:08:15] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:08:15] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:08:15] [INFO] [Scanner] Debug endpoint returned non-success status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:08:15] [INFO] [Scanner] Registering test user: test_user_1742584093_jta2iy
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to register test user: 404
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to register and login test user, skipping sensitive data test
[2025-03-21 14:08:15] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.00 seconds
[2025-03-21 14:08:15] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:08:15] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:08:15] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create user with endpoint /users/v1/register, status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to create user with endpoint: /users
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create user with endpoint /users, status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to create user with endpoint: /api/users
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create user with endpoint /api/users, status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to create user with endpoint: /api/v1/users
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create user with endpoint /api/v1/users, status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to create user with endpoint: /auth/sign-up
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create user with endpoint /auth/sign-up, status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to create user with endpoint: /api/v1/auth/sign-up
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create user with endpoint /api/v1/auth/sign-up, status code: 404
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create test user with any endpoint, skipping mass assignment test
[2025-03-21 14:08:15] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to get user accounts, status code: 404
[2025-03-21 14:08:15] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:08:15] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742584095' with admin privileges
[2025-03-21 14:08:15] [INFO] [Scanner] Registration with admin privileges was rejected with status code: 404
[2025-03-21 14:08:15] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 0.01 seconds
[2025-03-21 14:08:15] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:08:15] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:08:15] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:08:15] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:08:15] [WARNING] [Scanner] No existing accounts found, skipping unauthorized password change test
[2025-03-21 14:08:15] [INFO] [Scanner] Creating test accounts for unauthorized password change testing
[2025-03-21 14:08:15] [INFO] [Scanner] Creating test account 1: test_account_1742584095_hragjk_0
[2025-03-21 14:08:15] [WARNING] [Scanner] Failed to create test account, status code: 404
[2025-03-21 14:08:16] [INFO] [Scanner] Creating test account 2: test_account_1742584096_r5whwm_1
[2025-03-21 14:08:16] [WARNING] [Scanner] Failed to create test account, status code: 404
[2025-03-21 14:08:17] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:08:17] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:08:17] [WARNING] [Scanner] Still no accounts available after creating test accounts, skipping test
[2025-03-21 14:08:17] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 2.03 seconds
[2025-03-21 14:08:17] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:08:17] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:08:17] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:08:17] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742584097_standard_yvib@example.com
[2025-03-21 14:08:17] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742584097_standard_yvib@example.com, status code: 404
[2025-03-21 14:08:18] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742584097_premium_437m@example.com
[2025-03-21 14:08:18] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742584097_premium_437m@example.com, status code: 404
[2025-03-21 14:08:19] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742584097_admin_e33q@example.com
[2025-03-21 14:08:19] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742584097_admin_e33q@example.com, status code: 404
[2025-03-21 14:08:20] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:08:20] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:08:20] [INFO] [core.account_cache] Using cached account: test_user_1742584093_1
[2025-03-21 14:08:20] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:08:20] [INFO] [Scanner] Using cached account: test_user_1742584093_1
[2025-03-21 14:08:20] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:08:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:08:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:08:20] [WARNING] [Scanner] Failed to create test account: test_user_1742584093_1, status code: 404
[2025-03-21 14:08:20] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:08:20] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:08:20] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:08:20] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:08:20] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:08:21] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:08:21] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:08:21] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:08:21] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:08:22] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:08:22] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:08:22] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:08:22] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:08:23] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:08:23] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:08:23] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:08:23] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:08:24] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:08:24] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:08:24] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:08:24] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:08:25] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:08:25] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:08:25] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:08:25] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:08:26] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:08:26] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:08:26] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:08:26] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:08:27] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:08:27] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:08:27] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:08:27] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:08:28] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:08:28] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:08:28] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:08:28] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:08:28] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:08:28] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:08:31] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:08:32] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:08:33] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:08:33] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:08:33] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:08:33] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:08:36] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:08:41] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:08:47] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:08:47] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:08:47] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:08:47] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:08:50] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:08:57] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:09:05] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:09:05] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:09:05] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:09:05] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:09:08] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:09:18] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:09:27] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:09:27] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:09:27] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:09:27] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:09:30] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:09:39] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:09:49] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:09:49] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:09:49] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:09:49] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:09:49] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:09:49] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:09:58] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:10:08] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:10:08] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:10:08] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:10:08] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:10:08] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:10:08] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:10:08] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:10:08] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:10:08] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:10:08] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:10:08] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:10:08] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:10:08] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:10:08] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:10:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:10:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:10:08] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:10:08] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:10:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:10:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:10:08] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:10:08] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:10:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:10:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:10:08] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:10:08] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:10:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:10:08] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:10:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:10:08] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:10:08] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:10:08] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:10:08] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:10:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:10:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:10:08] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:10:08] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:10:08] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 111.40 seconds
[2025-03-21 14:10:08] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:10:08] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:10:08] [INFO] [Scanner] Using base_url as target URL: http://localhost:3000
[2025-03-21 14:10:08] [INFO] [Scanner] Target base URL: http://localhost:3000
[2025-03-21 14:10:08] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:10:08] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:10:08] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:10:08] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:10:08] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:10:08] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:10:08] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NDIwOCwiZXhwIjoxNzQ1MTc2MjA4fQ.nObpLv3LYo_rqVCX6NGc1nSTF4R2DPx7Cb2S5h2q8WY
[2025-03-21 14:10:08] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:10:08] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:10:08] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:10:08] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:10:08] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:10:08] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:10:08 (in 720.0 hours)
[2025-03-21 14:10:08] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:10:08] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:10:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:10:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:10:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:10:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:10:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:10:08] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:10:08] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:10:08] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:10:08] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:10:08] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:10:08] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:10:08] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:10:08] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:10:08] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:10:08] [INFO] [orchestrator] Scan ID: 20250321141008
[2025-03-21 14:10:08] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:10:08] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321141008.json
[2025-03-21 14:10:08] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321141008.json
[2025-03-21 14:10:08] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321141008.json
[2025-03-21 14:10:08] [INFO] [orchestrator] Scan completed. Found 11 potential vulnerabilities
[2025-03-21 14:13:21] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:13:21] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:13:21] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:13:21] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:13:21] [WARNING] [main] Failed to create test account: test1742584401@example.com, status: 404
[2025-03-21 14:13:21] [WARNING] [main] Failed to create test account: test1742584402@example.com, status: 404
[2025-03-21 14:13:21] [WARNING] [main] Failed to create test account: test1742584403@example.com, status: 404
[2025-03-21 14:13:21] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:13:21] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:13:21] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:13:21] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:13:21] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:13:21] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:13:21] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:13:21] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:13:21] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:13:21] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:13:21] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:13:21] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:13:21] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:21] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:13:21] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:13:21] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:13:21] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:13:21] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:13:21] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:21] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:13:21] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:13:21] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:13:21] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:13:21] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:13:21] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:13:21] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:13:21] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:13:21] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:13:21] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:21] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:13:21] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:13:21] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:13:21] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:13:21] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:13:21] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:13:21] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:13:21] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:13:21] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:13:21] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:21] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:13:21] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:13:21] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:13:21] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:13:21] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:13:21] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:13:21] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:13:21] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:13:21] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:21] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:13:21] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:13:21] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:13:21] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:13:21] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:13:21] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:13:21] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:13:21] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:13:21] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:13:21] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:21] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:13:21] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:13:21] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:13:21] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:13:21] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:13:21] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:13:21] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:13:21] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:13:22] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:13:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:22] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:13:22] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:13:22] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:13:22] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:13:22] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:13:22] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:13:22] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:13:22] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:13:22] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:13:22] [INFO] [core.account_cache] Added new account to cache: test_user_1742584402_1
[2025-03-21 14:13:22] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:13:22] [INFO] [orchestrator] Added test account to cache: test_user_1742584402_1
[2025-03-21 14:13:22] [INFO] [core.account_cache] Added new account to cache: test_user_1742584402_2
[2025-03-21 14:13:22] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:13:22] [INFO] [orchestrator] Added test account to cache: test_user_1742584402_2
[2025-03-21 14:13:22] [INFO] [core.account_cache] Added new account to cache: test_user_1742584402_3
[2025-03-21 14:13:22] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:13:22] [INFO] [orchestrator] Added test account to cache: test_user_1742584402_3
[2025-03-21 14:13:22] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:13:22] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:13:22] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:13:22] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Found 23 users in debug endpoint response
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:13:22] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:13:22] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:13:22] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:13:22] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:13:22] [INFO] [core.account_cache] Using cached account: test_user_1742584402_1
[2025-03-21 14:13:22] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:13:22] [INFO] [Scanner] Using cached account: test_user_1742584402_1
[2025-03-21 14:13:22] [INFO] [Scanner] Using existing test account: test_user_1742584402_1
[2025-03-21 14:13:22] [INFO] [Scanner] Logging in as user 'test_user_1742584402_1'
[2025-03-21 14:13:22] [INFO] [Scanner] Login payload: {"email": "test_user_1742584402_1", "password": "Test@1742584402_1"}
[2025-03-21 14:13:22] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:13:22] [WARNING] [Scanner] Failed to login as 'test_user_1742584402_1', status code: 400
[2025-03-21 14:13:22] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:13:22] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:13:22] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.17 seconds
[2025-03-21 14:13:22] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:13:22] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:13:22] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:13:22] [INFO] [Scanner] Found 23 existing accounts
[2025-03-21 14:13:22] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:13:22] [INFO] [Scanner] Registering user 'admin_user_1742584401_xhk2x0@example.com' with admin=True
[2025-03-21 14:13:22] [INFO] [Scanner] Successfully registered user 'admin_user_1742584401_xhk2x0@example.com'
[2025-03-21 14:13:23] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:13:23] [INFO] [Scanner] Found 24 existing accounts
[2025-03-21 14:13:23] [WARNING] [Scanner] User 'admin_user_1742584401_xhk2x0@example.com' was created with admin privileges
[2025-03-21 14:13:23] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:13:23] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:13:23] [INFO] [core.account_cache] Using cached account: test_user_1742584402_2
[2025-03-21 14:13:23] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:13:23] [INFO] [Scanner] Using cached account: test_user_1742584402_2
[2025-03-21 14:13:24] [INFO] [Scanner] Logging in as user 'test_user_1742584401_xhk2x0@example.com'
[2025-03-21 14:13:24] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:13:24] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:13:24] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:13:24] [INFO] [core.account_cache] Using cached account: test_user_1742584402_3
[2025-03-21 14:13:24] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:13:24] [INFO] [Scanner] Using cached account: test_user_1742584402_3
[2025-03-21 14:13:25] [INFO] [Scanner] Logging in as user 'test_user_1742584401_xhk2x0@example.com'
[2025-03-21 14:13:25] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:13:25] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:13:25] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:13:25] [INFO] [core.account_cache] Using cached account: test_user_1742584402_1
[2025-03-21 14:13:25] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:13:25] [INFO] [Scanner] Using cached account: test_user_1742584402_1
[2025-03-21 14:13:25] [INFO] [Scanner] Logging in as user 'test_user_1742584401_xhk2x0@example.com'
[2025-03-21 14:13:25] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:13:25] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:13:25] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.08 seconds
[2025-03-21 14:13:25] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:13:25] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:13:25] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:13:25] [INFO] [Scanner] Debug endpoint returned a 'users' array with 24 items
[2025-03-21 14:13:25] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:13:25] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321141325.json
[2025-03-21 14:13:25] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:13:25] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:13:25] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:13:25] [INFO] [Scanner] Registering test user: test_user_1742584401_s334o5
[2025-03-21 14:13:25] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:13:25] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:13:25] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:13:25] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:13:25] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:13:25] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:13:25] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:13:25] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:13:34] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:13:34] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:13:34] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:13:34] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:13:34] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:13:35] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:13:35] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:13:35] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:13:36] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:13:36] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:13:37] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:13:37] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742584417' with admin privileges
[2025-03-21 14:13:37] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742584417'
[2025-03-21 14:13:38] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:13:38] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.82 seconds
[2025-03-21 14:13:38] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:13:38] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:13:38] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:13:38] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:13:38] [INFO] [Scanner] Found 27 existing accounts
[2025-03-21 14:13:38] [INFO] [Scanner] Registering new test user 'test_user_1742584401_1obpt6' with admin privileges
[2025-03-21 14:13:38] [INFO] [Scanner] Successfully registered test user 'test_user_1742584401_1obpt6'
[2025-03-21 14:13:38] [INFO] [Scanner] Verifying test user 'test_user_1742584401_1obpt6' was created
[2025-03-21 14:13:39] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:13:39] [INFO] [Scanner] Found 28 existing accounts
[2025-03-21 14:13:39] [INFO] [Scanner] Verified test user 'test_user_1742584401_1obpt6' was created successfully
[2025-03-21 14:13:39] [INFO] [Scanner] Logging in as test user 'test_user_1742584401_1obpt6'
[2025-03-21 14:13:39] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:13:39] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:13:39] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:13:39] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:13:39] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:13:39] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:13:39] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.03 seconds
[2025-03-21 14:13:39] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:13:39] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:13:39] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:13:39] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742584419_standard_itox@example.com
[2025-03-21 14:13:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:39] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742584419_standard_itox@example.com, status code: 404
[2025-03-21 14:13:40] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742584419_premium_hr0s@example.com
[2025-03-21 14:13:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:40] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742584419_premium_hr0s@example.com, status code: 404
[2025-03-21 14:13:41] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742584419_admin_21lm@example.com
[2025-03-21 14:13:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:41] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742584419_admin_21lm@example.com, status code: 404
[2025-03-21 14:13:42] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:13:42] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:13:42] [INFO] [core.account_cache] Using cached account: test_user_1742584402_2
[2025-03-21 14:13:42] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:13:42] [INFO] [Scanner] Using cached account: test_user_1742584402_2
[2025-03-21 14:13:42] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:13:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:42] [WARNING] [Scanner] Failed to create test account: test_user_1742584402_2, status code: 404
[2025-03-21 14:13:42] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:13:42] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:13:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:42] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:13:42] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:13:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:42] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:13:43] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:13:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:43] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:13:43] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:13:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:43] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:13:44] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:13:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:44] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:13:44] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:13:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:44] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:13:45] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:13:45] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:45] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:45] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:45] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:13:45] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:13:45] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:45] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:45] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:45] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:13:46] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:13:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:46] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:13:46] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:13:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:46] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:13:47] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:13:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:47] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:13:47] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:13:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:47] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:13:48] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:13:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:48] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:13:48] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:13:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:48] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:13:49] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:13:49] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:13:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:49] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:13:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:49] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:13:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:50] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:13:50] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:13:50] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:13:50] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:13:50] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:13:50] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:13:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:53] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:13:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:54] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:13:55] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:55] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:55] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:55] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:13:55] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:13:55] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:13:55] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:13:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:13:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:13:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:13:58] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:14:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:04] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:14:10] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:10] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:10] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:10] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:14:10] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:14:10] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:14:10] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:14:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:13] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:14:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:22] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:14:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:30] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:14:30] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:14:30] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:14:30] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:14:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:33] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:14:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:43] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:14:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:53] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:14:53] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:14:53] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:14:53] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:14:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:14:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:14:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:14:56] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:15:05] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:05] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:05] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:05] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:15:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:15] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:15:15] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:15:15] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:15:15] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:15:15] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:15:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:15] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:15:24] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:24] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:24] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:24] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:15:35] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:15:35] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:15:35] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:15:35] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:15:35] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:15:35] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:15:35] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:15:35] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:15:35] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:15:35] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:15:35] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:15:35] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:15:35] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:15:35] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:15:35] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:15:35] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:15:35] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:15:35] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:15:35] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:15:35] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:15:35] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:15:35] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:15:35] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:15:35] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:15:35] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:15:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:15:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:15:35] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:15:35] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:15:35] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 116.60 seconds
[2025-03-21 14:15:35] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:15:35] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:15:35] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:15:35] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:15:35] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:15:35] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:15:35] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:15:35] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:15:35] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:15:35] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:15:35] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NDUzNSwiZXhwIjoxNzQ1MTc2NTM1fQ.6Ib86ds07U77nXy1T49-AYAHlbk6oPB9qYRfXptDVZU
[2025-03-21 14:15:35] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:15:35] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:15:35] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:15:35] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:15:35] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:15:35] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:15:35 (in 720.0 hours)
[2025-03-21 14:15:35] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:15:35] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:15:35] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:15:35] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:15:35] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:15:35] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:15:35] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:15:35] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:15:35] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:15:35] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:15:35] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:15:35] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:15:35] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:15:35] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:15:35] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:15:35] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:15:35] [INFO] [orchestrator] Scan ID: 20250321141535
[2025-03-21 14:15:35] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:15:35] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321141535.json
[2025-03-21 14:15:35] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321141535.json
[2025-03-21 14:15:35] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321141535.json
[2025-03-21 14:15:35] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:23:16] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:23:16] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:23:16] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:23:16] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:23:16] [WARNING] [main] Failed to create test account: test1742584996@example.com, status: 404
[2025-03-21 14:23:16] [WARNING] [main] Failed to create test account: test1742584997@example.com, status: 404
[2025-03-21 14:23:16] [WARNING] [main] Failed to create test account: test1742584998@example.com, status: 404
[2025-03-21 14:23:16] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:23:16] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:23:16] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:23:16] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:23:16] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:23:16] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:23:16] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:23:16] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:23:16] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:23:16] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:23:16] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:23:16] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:23:16] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:23:16] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:23:16] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:23:16] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:23:16] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:23:16] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:23:16] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:23:16] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:23:16] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:23:16] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:23:16] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:23:16] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:23:16] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:23:16] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:23:16] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:23:16] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:23:16] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:23:16] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:23:16] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:23:16] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:23:16] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:23:16] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:23:16] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:23:16] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:23:16] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:23:16] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:23:16] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:23:16] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:23:16] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:23:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:16] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:23:16] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:23:16] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:23:16] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:23:16] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:23:16] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:23:16] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:23:16] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:23:16] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:23:16] [INFO] [core.account_cache] Added new account to cache: test_user_1742584996_1
[2025-03-21 14:23:16] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:23:16] [INFO] [orchestrator] Added test account to cache: test_user_1742584996_1
[2025-03-21 14:23:16] [INFO] [core.account_cache] Added new account to cache: test_user_1742584996_2
[2025-03-21 14:23:16] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:23:16] [INFO] [orchestrator] Added test account to cache: test_user_1742584996_2
[2025-03-21 14:23:16] [INFO] [core.account_cache] Added new account to cache: test_user_1742584996_3
[2025-03-21 14:23:16] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:23:16] [INFO] [orchestrator] Added test account to cache: test_user_1742584996_3
[2025-03-21 14:23:16] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:23:16] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:23:16] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:23:16] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Found 28 users in debug endpoint response
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 14:23:16] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:23:16] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:23:16] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 14:23:16] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 14:23:16] [INFO] [core.account_cache] Using cached account: test_user_1742584996_1
[2025-03-21 14:23:16] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:23:16] [INFO] [Scanner] Using cached account: test_user_1742584996_1
[2025-03-21 14:23:16] [INFO] [Scanner] Using existing test account: test_user_1742584996_1
[2025-03-21 14:23:16] [INFO] [Scanner] Logging in as user 'test_user_1742584996_1'
[2025-03-21 14:23:16] [INFO] [Scanner] Login payload: {"email": "test_user_1742584996_1", "password": "Test@1742584996_1"}
[2025-03-21 14:23:16] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:23:16] [WARNING] [Scanner] Failed to login as 'test_user_1742584996_1', status code: 400
[2025-03-21 14:23:16] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:23:16] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:23:16] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.20 seconds
[2025-03-21 14:23:16] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:23:16] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:23:16] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:23:16] [INFO] [Scanner] Found 28 existing accounts
[2025-03-21 14:23:16] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:23:16] [INFO] [Scanner] Registering user 'admin_user_1742584996_t97cji@example.com' with admin=True
[2025-03-21 14:23:16] [INFO] [Scanner] Successfully registered user 'admin_user_1742584996_t97cji@example.com'
[2025-03-21 14:23:17] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:23:17] [INFO] [Scanner] Found 29 existing accounts
[2025-03-21 14:23:17] [WARNING] [Scanner] User 'admin_user_1742584996_t97cji@example.com' was created with admin privileges
[2025-03-21 14:23:17] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:23:17] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:23:17] [INFO] [core.account_cache] Using cached account: test_user_1742584996_2
[2025-03-21 14:23:17] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:23:17] [INFO] [Scanner] Using cached account: test_user_1742584996_2
[2025-03-21 14:23:18] [INFO] [Scanner] Logging in as user 'test_user_1742584996_t97cji@example.com'
[2025-03-21 14:23:18] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:23:18] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:23:18] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:23:18] [INFO] [core.account_cache] Using cached account: test_user_1742584996_3
[2025-03-21 14:23:18] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:23:18] [INFO] [Scanner] Using cached account: test_user_1742584996_3
[2025-03-21 14:23:19] [INFO] [Scanner] Logging in as user 'test_user_1742584996_t97cji@example.com'
[2025-03-21 14:23:19] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:23:19] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:23:19] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:23:19] [INFO] [core.account_cache] Using cached account: test_user_1742584996_1
[2025-03-21 14:23:19] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:23:19] [INFO] [Scanner] Using cached account: test_user_1742584996_1
[2025-03-21 14:23:19] [INFO] [Scanner] Logging in as user 'test_user_1742584996_t97cji@example.com'
[2025-03-21 14:23:19] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:23:19] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:23:19] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.06 seconds
[2025-03-21 14:23:19] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:23:19] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:23:19] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:23:19] [INFO] [Scanner] Debug endpoint returned a 'users' array with 29 items
[2025-03-21 14:23:19] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:23:19] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321142319.json
[2025-03-21 14:23:19] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:23:19] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:23:19] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:23:19] [INFO] [Scanner] Registering test user: test_user_1742584996_571j6d
[2025-03-21 14:23:19] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:23:19] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:23:19] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:23:19] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:23:19] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:23:19] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:23:19] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:23:19] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:23:28] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:23:28] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:23:28] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:23:28] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:23:28] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:23:29] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:23:29] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:23:29] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:23:30] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:23:30] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:23:31] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:23:31] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742585011' with admin privileges
[2025-03-21 14:23:31] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742585011'
[2025-03-21 14:23:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:23:32] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.80 seconds
[2025-03-21 14:23:32] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:23:32] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:23:32] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:23:32] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:23:32] [INFO] [Scanner] Found 32 existing accounts
[2025-03-21 14:23:32] [INFO] [Scanner] Registering new test user 'test_user_1742584996_4xqs5x' with admin privileges
[2025-03-21 14:23:32] [INFO] [Scanner] Successfully registered test user 'test_user_1742584996_4xqs5x'
[2025-03-21 14:23:32] [INFO] [Scanner] Verifying test user 'test_user_1742584996_4xqs5x' was created
[2025-03-21 14:23:33] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:23:33] [INFO] [Scanner] Found 33 existing accounts
[2025-03-21 14:23:33] [INFO] [Scanner] Verified test user 'test_user_1742584996_4xqs5x' was created successfully
[2025-03-21 14:23:33] [INFO] [Scanner] Logging in as test user 'test_user_1742584996_4xqs5x'
[2025-03-21 14:23:33] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:23:33] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:23:33] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:23:33] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:23:33] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:23:33] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:23:33] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.05 seconds
[2025-03-21 14:23:33] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:23:33] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:23:33] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:23:33] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742585013_standard_zhmd@example.com
[2025-03-21 14:23:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:33] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742585013_standard_zhmd@example.com, status code: 404
[2025-03-21 14:23:34] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742585013_premium_d8zw@example.com
[2025-03-21 14:23:34] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:34] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:34] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:34] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742585013_premium_d8zw@example.com, status code: 404
[2025-03-21 14:23:35] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742585013_admin_vril@example.com
[2025-03-21 14:23:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:35] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742585013_admin_vril@example.com, status code: 404
[2025-03-21 14:23:36] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:23:36] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:23:36] [INFO] [core.account_cache] Using cached account: test_user_1742584996_2
[2025-03-21 14:23:36] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:23:36] [INFO] [Scanner] Using cached account: test_user_1742584996_2
[2025-03-21 14:23:36] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:23:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:36] [WARNING] [Scanner] Failed to create test account: test_user_1742584996_2, status code: 404
[2025-03-21 14:23:36] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:23:36] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:23:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:36] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:23:36] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:23:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:36] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:23:37] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:23:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:37] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:23:37] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:23:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:37] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:23:38] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:23:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:38] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:23:38] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:23:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:38] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:23:39] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:23:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:39] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:23:39] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:23:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:39] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:23:40] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:23:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:40] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:23:40] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:23:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:40] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:23:41] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:23:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:41] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:23:41] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:23:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:41] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:23:42] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:23:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:42] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:23:42] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:23:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:42] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:23:43] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:23:43] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:23:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:43] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:23:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:44] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:23:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:44] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:23:44] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:23:44] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:23:44] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:23:44] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:23:44] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:23:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:47] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:23:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:48] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:23:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:49] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:23:49] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:23:49] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:23:49] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:23:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:52] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:23:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:23:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:23:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:23:58] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:24:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:04] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:24:04] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:24:04] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:24:04] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:24:07] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:07] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:07] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:07] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:24:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:16] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:24:24] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:24] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:24] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:24] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:24:24] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:24:24] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:24:24] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:24:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:27] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:24:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:36] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:24:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:44] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:24:44] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:24:44] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:24:44] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:24:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:47] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:24:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:24:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:24:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:24:56] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:25:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:06] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:25:06] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:25:06] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:25:06] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:25:06] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:25:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:06] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:25:16] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:16] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:16] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:25:26] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:25:26] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:25:26] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:25:26] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:25:26] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:25:26] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:25:26] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:25:26] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:25:26] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:25:26] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:25:26] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:25:26] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:25:26] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:25:26] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:25:26] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:25:26] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:25:26] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:25:26] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:25:26] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:25:26] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:25:26] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:25:26] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:25:26] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:25:26] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:25:26] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:25:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:25:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:25:26] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:25:26] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:25:26] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 113.67 seconds
[2025-03-21 14:25:26] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:25:26] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:25:26] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:25:26] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:25:26] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:25:26] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:25:26] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:25:26] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:25:26] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:25:26] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:25:26] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NTEyNiwiZXhwIjoxNzQ1MTc3MTI2fQ.-Cx_5MsvixJ42CIaPeviGaMjt1hiv5J9cH_ytrMpNEA
[2025-03-21 14:25:26] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:25:26] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:25:26] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:25:26] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:25:26] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:25:26] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:25:26 (in 720.0 hours)
[2025-03-21 14:25:26] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:25:26] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:25:26] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:25:26] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:25:26] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:25:26] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:25:26] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:25:26] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:25:26] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:25:26] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:25:26] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:25:26] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:25:26] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:25:26] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:25:26] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:25:26] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:25:26] [INFO] [orchestrator] Scan ID: 20250321142526
[2025-03-21 14:25:26] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:25:26] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321142526.json
[2025-03-21 14:25:26] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321142526.json
[2025-03-21 14:25:26] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321142526.json
[2025-03-21 14:25:26] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:29:09] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:29:09] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:29:09] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:29:09] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:29:09] [WARNING] [main] Failed to create test account: test1742585349@example.com, status: 404
[2025-03-21 14:29:09] [WARNING] [main] Failed to create test account: test1742585350@example.com, status: 404
[2025-03-21 14:29:09] [WARNING] [main] Failed to create test account: test1742585351@example.com, status: 404
[2025-03-21 14:29:09] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:29:09] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:29:09] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:29:09] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:29:09] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:29:09] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:29:09] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:29:09] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:29:09] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:29:09] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:29:09] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:29:09] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:29:09] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:29:09] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:29:09] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:29:09] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:29:09] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:29:09] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:29:09] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:29:09] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:29:09] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:29:09] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:29:09] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:29:09] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:29:09] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:29:09] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:29:09] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:29:09] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:29:09] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:29:09] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:29:09] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:29:09] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:29:09] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:29:09] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:29:09] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:29:09] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:29:09] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:29:09] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:29:09] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:29:09] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:29:09] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:29:09] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:29:09] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:29:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:09] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:29:09] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:29:09] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:29:09] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:29:09] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:29:09] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:29:09] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:29:09] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:29:09] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:29:09] [INFO] [core.account_cache] Added new account to cache: test_user_1742585349_1
[2025-03-21 14:29:09] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:29:09] [INFO] [orchestrator] Added test account to cache: test_user_1742585349_1
[2025-03-21 14:29:09] [INFO] [core.account_cache] Added new account to cache: test_user_1742585349_2
[2025-03-21 14:29:09] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:29:09] [INFO] [orchestrator] Added test account to cache: test_user_1742585349_2
[2025-03-21 14:29:09] [INFO] [core.account_cache] Added new account to cache: test_user_1742585349_3
[2025-03-21 14:29:09] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:29:09] [INFO] [orchestrator] Added test account to cache: test_user_1742585349_3
[2025-03-21 14:29:09] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:29:09] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:29:09] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:29:09] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:29:09] [INFO] [Scanner] Found 33 users in debug endpoint response
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:29:09] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:29:09] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:29:09] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:29:09] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:29:09] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:29:09] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:29:09] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 14:29:10] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:29:10] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:29:10] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 14:29:10] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 14:29:10] [INFO] [core.account_cache] Using cached account: test_user_1742585349_1
[2025-03-21 14:29:10] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:29:10] [INFO] [Scanner] Using cached account: test_user_1742585349_1
[2025-03-21 14:29:10] [INFO] [Scanner] Using existing test account: test_user_1742585349_1
[2025-03-21 14:29:10] [INFO] [Scanner] Logging in as user 'test_user_1742585349_1'
[2025-03-21 14:29:10] [INFO] [Scanner] Login payload: {"email": "test_user_1742585349_1", "password": "Test@1742585349_1"}
[2025-03-21 14:29:10] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:29:10] [WARNING] [Scanner] Failed to login as 'test_user_1742585349_1', status code: 400
[2025-03-21 14:29:10] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:29:10] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:29:10] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.20 seconds
[2025-03-21 14:29:10] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:29:10] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:29:10] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:29:10] [INFO] [Scanner] Found 33 existing accounts
[2025-03-21 14:29:10] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:29:10] [INFO] [Scanner] Registering user 'admin_user_1742585349_8924l4@example.com' with admin=True
[2025-03-21 14:29:10] [INFO] [Scanner] Successfully registered user 'admin_user_1742585349_8924l4@example.com'
[2025-03-21 14:29:11] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:29:11] [INFO] [Scanner] Found 34 existing accounts
[2025-03-21 14:29:11] [WARNING] [Scanner] User 'admin_user_1742585349_8924l4@example.com' was created with admin privileges
[2025-03-21 14:29:11] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:29:11] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:29:11] [INFO] [core.account_cache] Using cached account: test_user_1742585349_2
[2025-03-21 14:29:11] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:29:11] [INFO] [Scanner] Using cached account: test_user_1742585349_2
[2025-03-21 14:29:12] [INFO] [Scanner] Logging in as user 'test_user_1742585349_8924l4@example.com'
[2025-03-21 14:29:12] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:29:12] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:29:12] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:29:12] [INFO] [core.account_cache] Using cached account: test_user_1742585349_3
[2025-03-21 14:29:12] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:29:12] [INFO] [Scanner] Using cached account: test_user_1742585349_3
[2025-03-21 14:29:13] [INFO] [Scanner] Logging in as user 'test_user_1742585349_8924l4@example.com'
[2025-03-21 14:29:13] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:29:13] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:29:13] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:29:13] [INFO] [core.account_cache] Using cached account: test_user_1742585349_1
[2025-03-21 14:29:13] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:29:13] [INFO] [Scanner] Using cached account: test_user_1742585349_1
[2025-03-21 14:29:13] [INFO] [Scanner] Logging in as user 'test_user_1742585349_8924l4@example.com'
[2025-03-21 14:29:13] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:29:13] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:29:13] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.07 seconds
[2025-03-21 14:29:13] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:29:13] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:29:13] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:29:13] [INFO] [Scanner] Debug endpoint returned a 'users' array with 34 items
[2025-03-21 14:29:13] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:29:13] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321142913.json
[2025-03-21 14:29:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:29:13] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:29:13] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:29:13] [INFO] [Scanner] Registering test user: test_user_1742585349_pqanxo
[2025-03-21 14:29:13] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:29:13] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:29:13] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:29:13] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:29:13] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:29:13] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:29:13] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:29:13] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:29:21] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:29:21] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:29:21] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:29:21] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:29:22] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:29:22] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:29:23] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:29:23] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:29:23] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:29:24] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:29:25] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:29:25] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742585365' with admin privileges
[2025-03-21 14:29:25] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742585365'
[2025-03-21 14:29:26] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:29:26] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.84 seconds
[2025-03-21 14:29:26] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:29:26] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:29:26] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:29:26] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:29:26] [INFO] [Scanner] Found 37 existing accounts
[2025-03-21 14:29:26] [INFO] [Scanner] Registering new test user 'test_user_1742585349_h24e9d' with admin privileges
[2025-03-21 14:29:26] [INFO] [Scanner] Successfully registered test user 'test_user_1742585349_h24e9d'
[2025-03-21 14:29:26] [INFO] [Scanner] Verifying test user 'test_user_1742585349_h24e9d' was created
[2025-03-21 14:29:27] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:29:27] [INFO] [Scanner] Found 38 existing accounts
[2025-03-21 14:29:27] [INFO] [Scanner] Verified test user 'test_user_1742585349_h24e9d' was created successfully
[2025-03-21 14:29:27] [INFO] [Scanner] Logging in as test user 'test_user_1742585349_h24e9d'
[2025-03-21 14:29:27] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:29:27] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:29:27] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:29:27] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:29:27] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:29:27] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:29:27] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.06 seconds
[2025-03-21 14:29:27] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:29:27] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:29:27] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:29:27] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742585367_standard_thrz@example.com
[2025-03-21 14:29:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:27] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742585367_standard_thrz@example.com, status code: 404
[2025-03-21 14:29:28] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742585367_premium_06xb@example.com
[2025-03-21 14:29:28] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:28] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:28] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:28] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742585367_premium_06xb@example.com, status code: 404
[2025-03-21 14:29:29] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742585367_admin_m2cb@example.com
[2025-03-21 14:29:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:29] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742585367_admin_m2cb@example.com, status code: 404
[2025-03-21 14:29:30] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:29:30] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:29:30] [INFO] [core.account_cache] Using cached account: test_user_1742585349_2
[2025-03-21 14:29:30] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:29:30] [INFO] [Scanner] Using cached account: test_user_1742585349_2
[2025-03-21 14:29:30] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:29:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:30] [WARNING] [Scanner] Failed to create test account: test_user_1742585349_2, status code: 404
[2025-03-21 14:29:30] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:29:30] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:29:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:30] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:29:30] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:29:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:30] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:29:31] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:29:31] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:31] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:31] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:31] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:29:31] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:29:31] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:31] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:31] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:31] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:29:32] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:29:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:32] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:29:32] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:29:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:32] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:29:33] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:29:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:33] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:29:33] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:29:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:33] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:29:34] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:29:34] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:34] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:34] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:34] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:29:34] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:29:34] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:34] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:34] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:34] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:29:35] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:29:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:35] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:29:35] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:29:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:35] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:29:36] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:29:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:36] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:29:36] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:29:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:36] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:29:37] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:29:37] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:29:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:37] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:29:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:38] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:29:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:38] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:29:38] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:29:38] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:29:38] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:29:38] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:29:38] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:29:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:41] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:29:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:42] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:29:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:43] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:29:43] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:29:43] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:29:43] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:29:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:46] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:29:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:52] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:29:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:29:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:29:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:29:58] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:29:58] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:29:58] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:29:58] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:30:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:01] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:30:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:08] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:30:16] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:16] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:16] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:30:16] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:30:16] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:30:16] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:30:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:19] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:30:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:29] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:30:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:37] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:30:37] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:30:37] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:30:37] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:30:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:40] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:30:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:30:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:30:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:30:50] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:31:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:00] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:31:00] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:31:00] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:31:00] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:31:00] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:31:00] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:00] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:00] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:00] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:31:10] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:10] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:10] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:10] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:31:21] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:31:21] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:31:21] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:31:21] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:31:21] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:31:21] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:31:21] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:31:21] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:31:21] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:31:21] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:31:21] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:31:21] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:31:21] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:31:21] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:31:21] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:31:21] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:31:21] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:31:21] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:31:21] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:31:21] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:31:21] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:31:21] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:31:21] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:31:21] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:31:21] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:31:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:31:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:31:21] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:31:21] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:31:21] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 114.60 seconds
[2025-03-21 14:31:21] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:31:21] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:31:21] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:31:21] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:31:21] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:31:21] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:31:21] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:31:21] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:31:21] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:31:21] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:31:21] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NTQ4MSwiZXhwIjoxNzQ1MTc3NDgxfQ.D-cxPMwQgTk6AnFZ-saarfXmq6aBdnjNrhq6aJQMrOY
[2025-03-21 14:31:21] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:31:21] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:31:21] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:31:21] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:31:21] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:31:21] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:31:21 (in 720.0 hours)
[2025-03-21 14:31:21] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:31:21] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:31:21] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:31:21] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:31:21] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:31:21] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:31:21] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:31:21] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:31:21] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:31:21] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:31:21] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:31:21] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:31:21] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:31:21] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:31:21] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:31:21] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:31:21] [INFO] [orchestrator] Scan ID: 20250321143121
[2025-03-21 14:31:21] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:31:21] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321143121.json
[2025-03-21 14:31:21] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321143121.json
[2025-03-21 14:31:21] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321143121.json
[2025-03-21 14:31:21] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:35:54] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:35:54] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:35:54] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:35:54] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:35:54] [WARNING] [main] Failed to create test account: test1742585754@example.com, status: 404
[2025-03-21 14:35:54] [WARNING] [main] Failed to create test account: test1742585755@example.com, status: 404
[2025-03-21 14:35:54] [WARNING] [main] Failed to create test account: test1742585756@example.com, status: 404
[2025-03-21 14:35:54] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:35:54] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:35:54] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:35:54] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:35:54] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:35:54] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:35:54] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:35:54] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:35:54] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:35:54] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:35:54] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:35:54] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:35:54] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:35:54] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:35:54] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:35:54] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:35:54] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:35:54] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:35:54] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:35:54] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:35:54] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:35:54] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:35:54] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:35:54] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:35:54] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:35:54] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:35:54] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:35:54] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:35:54] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:35:54] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:35:54] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:35:54] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:35:54] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:35:54] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:35:54] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:35:54] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:35:54] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:35:54] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:35:54] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:35:54] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:35:54] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:35:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:35:54] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:35:54] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:35:54] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:35:54] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:35:54] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:35:54] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:35:54] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:35:54] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:35:54] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:35:54] [INFO] [core.account_cache] Added new account to cache: test_user_1742585754_1
[2025-03-21 14:35:54] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:35:54] [INFO] [orchestrator] Added test account to cache: test_user_1742585754_1
[2025-03-21 14:35:54] [INFO] [core.account_cache] Added new account to cache: test_user_1742585754_2
[2025-03-21 14:35:54] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:35:54] [INFO] [orchestrator] Added test account to cache: test_user_1742585754_2
[2025-03-21 14:35:54] [INFO] [core.account_cache] Added new account to cache: test_user_1742585754_3
[2025-03-21 14:35:54] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:35:54] [INFO] [orchestrator] Added test account to cache: test_user_1742585754_3
[2025-03-21 14:35:54] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:35:54] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:35:54] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:35:54] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Found 38 users in debug endpoint response
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: admin_user_1742585349_8924l4@example.com, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742585349_pqanxo from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742585349_pqanxo, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585349, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585365
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585365
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585365, status code: 400
[2025-03-21 14:35:54] [INFO] [Scanner] Found credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:35:54] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:35:54] [INFO] [Scanner] Updated password for user test_user_1742585349_h24e9d from debug endpoint
[2025-03-21 14:35:54] [INFO] [Scanner] Login failed for user: test_user_1742585349_h24e9d, status code: 400
[2025-03-21 14:35:54] [INFO] [core.account_cache] Using cached account: test_user_1742585754_1
[2025-03-21 14:35:54] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:35:54] [INFO] [Scanner] Using cached account: test_user_1742585754_1
[2025-03-21 14:35:54] [INFO] [Scanner] Using existing test account: test_user_1742585754_1
[2025-03-21 14:35:54] [INFO] [Scanner] Logging in as user 'test_user_1742585754_1'
[2025-03-21 14:35:54] [INFO] [Scanner] Login payload: {"email": "test_user_1742585754_1", "password": "Test@1742585754_1"}
[2025-03-21 14:35:54] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:35:54] [WARNING] [Scanner] Failed to login as 'test_user_1742585754_1', status code: 400
[2025-03-21 14:35:54] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:35:54] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:35:54] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.26 seconds
[2025-03-21 14:35:54] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:35:54] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:35:54] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:35:54] [INFO] [Scanner] Found 38 existing accounts
[2025-03-21 14:35:54] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:35:54] [INFO] [Scanner] Registering user 'admin_user_1742585754_admodu@example.com' with admin=True
[2025-03-21 14:35:54] [INFO] [Scanner] Successfully registered user 'admin_user_1742585754_admodu@example.com'
[2025-03-21 14:35:55] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:35:55] [INFO] [Scanner] Found 39 existing accounts
[2025-03-21 14:35:55] [WARNING] [Scanner] User 'admin_user_1742585754_admodu@example.com' was created with admin privileges
[2025-03-21 14:35:55] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:35:55] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:35:55] [INFO] [core.account_cache] Using cached account: test_user_1742585754_2
[2025-03-21 14:35:55] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:35:55] [INFO] [Scanner] Using cached account: test_user_1742585754_2
[2025-03-21 14:35:56] [INFO] [Scanner] Logging in as user 'test_user_1742585754_admodu@example.com'
[2025-03-21 14:35:56] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:35:56] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:35:56] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:35:56] [INFO] [core.account_cache] Using cached account: test_user_1742585754_3
[2025-03-21 14:35:56] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:35:56] [INFO] [Scanner] Using cached account: test_user_1742585754_3
[2025-03-21 14:35:57] [INFO] [Scanner] Logging in as user 'test_user_1742585754_admodu@example.com'
[2025-03-21 14:35:57] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:35:57] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:35:57] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:35:57] [INFO] [core.account_cache] Using cached account: test_user_1742585754_1
[2025-03-21 14:35:57] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:35:57] [INFO] [Scanner] Using cached account: test_user_1742585754_1
[2025-03-21 14:35:57] [INFO] [Scanner] Logging in as user 'test_user_1742585754_admodu@example.com'
[2025-03-21 14:35:57] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:35:57] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:35:57] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.07 seconds
[2025-03-21 14:35:57] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:35:57] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:35:57] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:35:57] [INFO] [Scanner] Debug endpoint returned a 'users' array with 39 items
[2025-03-21 14:35:57] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:35:57] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321143557.json
[2025-03-21 14:35:57] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:35:57] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:35:57] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:35:57] [INFO] [Scanner] Registering test user: test_user_1742585754_yeii3o
[2025-03-21 14:35:57] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:35:57] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:35:57] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:35:57] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:35:57] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:35:57] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:35:57] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:35:57] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:36:06] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:36:06] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:36:06] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:36:06] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:36:06] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:36:07] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:36:07] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:36:07] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:36:08] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:36:08] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:36:09] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:36:09] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742585769' with admin privileges
[2025-03-21 14:36:09] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742585769'
[2025-03-21 14:36:10] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:36:10] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.79 seconds
[2025-03-21 14:36:10] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:36:10] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:36:10] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:36:10] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:36:10] [INFO] [Scanner] Found 42 existing accounts
[2025-03-21 14:36:10] [INFO] [Scanner] Registering new test user 'test_user_1742585754_x5lhes' with admin privileges
[2025-03-21 14:36:10] [INFO] [Scanner] Successfully registered test user 'test_user_1742585754_x5lhes'
[2025-03-21 14:36:10] [INFO] [Scanner] Verifying test user 'test_user_1742585754_x5lhes' was created
[2025-03-21 14:36:11] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:36:11] [INFO] [Scanner] Found 43 existing accounts
[2025-03-21 14:36:11] [INFO] [Scanner] Verified test user 'test_user_1742585754_x5lhes' was created successfully
[2025-03-21 14:36:11] [INFO] [Scanner] Logging in as test user 'test_user_1742585754_x5lhes'
[2025-03-21 14:36:11] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:36:11] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:36:11] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:36:11] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:36:11] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:36:11] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:36:11] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.05 seconds
[2025-03-21 14:36:11] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:36:11] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:36:11] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:36:11] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742585771_standard_5ti7@example.com
[2025-03-21 14:36:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:11] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742585771_standard_5ti7@example.com, status code: 404
[2025-03-21 14:36:12] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742585771_premium_rz0j@example.com
[2025-03-21 14:36:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:12] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742585771_premium_rz0j@example.com, status code: 404
[2025-03-21 14:36:13] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742585771_admin_xrjz@example.com
[2025-03-21 14:36:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:13] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742585771_admin_xrjz@example.com, status code: 404
[2025-03-21 14:36:14] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:36:14] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:36:14] [INFO] [core.account_cache] Using cached account: test_user_1742585754_2
[2025-03-21 14:36:14] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:36:14] [INFO] [Scanner] Using cached account: test_user_1742585754_2
[2025-03-21 14:36:14] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:36:14] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:14] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:14] [WARNING] [Scanner] Failed to create test account: test_user_1742585754_2, status code: 404
[2025-03-21 14:36:14] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:36:14] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:36:14] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:14] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:14] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:14] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:36:15] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:36:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:15] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:36:15] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:36:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:15] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:36:16] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:36:16] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:16] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:16] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:36:16] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:36:16] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:16] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:16] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:36:17] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:36:17] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:17] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:17] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:17] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:36:17] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:36:17] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:17] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:17] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:17] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:36:18] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:36:18] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:18] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:18] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:18] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:36:18] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:36:18] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:18] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:18] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:18] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:36:19] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:36:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:19] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:36:19] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:36:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:19] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:36:20] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:36:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:20] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:36:20] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:36:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:20] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:36:21] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:36:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:21] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:36:21] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:36:21] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:36:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:21] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:36:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:22] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:36:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:22] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:36:22] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:36:22] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:36:22] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:36:22] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:36:22] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:36:25] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:25] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:25] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:25] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:36:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:26] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:36:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:27] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:36:27] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:36:27] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:36:27] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:36:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:30] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:36:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:36] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:36:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:42] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:36:42] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:36:42] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:36:42] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:36:45] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:45] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:45] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:45] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:36:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:36:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:36:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:36:53] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:37:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:01] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:37:01] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:37:01] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:37:01] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:37:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:04] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:37:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:13] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:37:23] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:23] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:23] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:23] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:37:23] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:37:23] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:37:23] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:37:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:26] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:37:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:36] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:37:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:47] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:37:47] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:37:47] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:37:47] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:37:47] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:37:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:47] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:37:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:37:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:37:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:37:57] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:38:06] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:38:06] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:38:06] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:38:06] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:38:06] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:38:06] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:38:06] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:38:06] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:38:06] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:38:06] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:38:06] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:38:06] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:38:06] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:38:06] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:38:06] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:38:06] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:38:06] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:38:06] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:38:06] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:38:06] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:38:06] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:38:06] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:38:06] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:38:06] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:38:06] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:38:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:38:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:38:06] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:38:06] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:38:06] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 115.03 seconds
[2025-03-21 14:38:06] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:38:06] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:38:06] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:38:06] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:38:06] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:38:06] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:38:06] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:38:06] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:38:06] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:38:06] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:38:06] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NTg4NiwiZXhwIjoxNzQ1MTc3ODg2fQ.eVLsv8yDS9XUyFlZRJmulo0QVYK6KThfB-SBL7XIN_I
[2025-03-21 14:38:06] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:38:06] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:38:06] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:38:06] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:38:06] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:38:06] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:38:06 (in 720.0 hours)
[2025-03-21 14:38:06] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:38:06] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:38:06] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:38:06] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:38:06] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:38:06] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:38:06] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:38:06] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:38:06] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:38:06] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:38:06] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:38:06] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:38:06] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:38:06] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:38:06] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:38:06] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:38:06] [INFO] [orchestrator] Scan ID: 20250321143806
[2025-03-21 14:38:06] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:38:06] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321143806.json
[2025-03-21 14:38:06] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321143806.json
[2025-03-21 14:38:06] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321143806.json
[2025-03-21 14:38:06] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:40:11] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:40:11] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:40:11] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:40:11] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:40:11] [WARNING] [main] Failed to create test account: test1742586011@example.com, status: 404
[2025-03-21 14:40:11] [WARNING] [main] Failed to create test account: test1742586012@example.com, status: 404
[2025-03-21 14:40:11] [WARNING] [main] Failed to create test account: test1742586013@example.com, status: 404
[2025-03-21 14:40:11] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:40:11] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:40:11] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:40:11] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:40:11] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:40:11] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:40:11] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:40:11] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:40:11] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:40:11] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:40:11] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:40:11] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:40:11] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:40:11] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:40:11] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:40:11] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:40:11] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:40:11] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:40:11] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:40:11] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:40:11] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:40:11] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:40:11] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:40:11] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:40:11] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:40:11] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:40:11] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:40:11] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:40:11] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:40:11] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:40:11] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:40:11] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:40:11] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:40:11] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:40:11] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:40:11] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:40:11] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:40:11] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:40:11] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:40:11] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:40:11] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:40:11] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:40:11] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:40:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:11] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:40:11] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:40:11] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:40:11] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:40:11] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:40:11] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:40:11] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:40:11] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:40:11] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:40:11] [INFO] [core.account_cache] Added new account to cache: test_user_1742586011_1
[2025-03-21 14:40:11] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:40:11] [INFO] [orchestrator] Added test account to cache: test_user_1742586011_1
[2025-03-21 14:40:11] [INFO] [core.account_cache] Added new account to cache: test_user_1742586011_2
[2025-03-21 14:40:11] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:40:11] [INFO] [orchestrator] Added test account to cache: test_user_1742586011_2
[2025-03-21 14:40:11] [INFO] [core.account_cache] Added new account to cache: test_user_1742586011_3
[2025-03-21 14:40:11] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:40:11] [INFO] [orchestrator] Added test account to cache: test_user_1742586011_3
[2025-03-21 14:40:11] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:40:11] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:40:11] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:40:11] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:40:11] [INFO] [Scanner] Found 43 users in debug endpoint response
[2025-03-21 14:40:11] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:40:11] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742585349_8924l4@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742585349_pqanxo from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742585349_pqanxo, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585349, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585365
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585365
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585365, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742585349_h24e9d from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742585349_h24e9d, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: admin_user_1742585754_admodu@example.com, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742585754_yeii3o
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_yeii3o
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742585754_yeii3o from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742585754_yeii3o, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585754
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585754
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585754, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585769
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585769
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585769, status code: 400
[2025-03-21 14:40:12] [INFO] [Scanner] Found credentials for user: test_user_1742585754_x5lhes
[2025-03-21 14:40:12] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_x5lhes
[2025-03-21 14:40:12] [INFO] [Scanner] Updated password for user test_user_1742585754_x5lhes from debug endpoint
[2025-03-21 14:40:12] [INFO] [Scanner] Login failed for user: test_user_1742585754_x5lhes, status code: 400
[2025-03-21 14:40:12] [INFO] [core.account_cache] Using cached account: test_user_1742586011_1
[2025-03-21 14:40:12] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:40:12] [INFO] [Scanner] Using cached account: test_user_1742586011_1
[2025-03-21 14:40:12] [INFO] [Scanner] Using existing test account: test_user_1742586011_1
[2025-03-21 14:40:12] [INFO] [Scanner] Logging in as user 'test_user_1742586011_1'
[2025-03-21 14:40:12] [INFO] [Scanner] Login payload: {"email": "test_user_1742586011_1", "password": "Test@1742586011_1"}
[2025-03-21 14:40:12] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:40:12] [WARNING] [Scanner] Failed to login as 'test_user_1742586011_1', status code: 400
[2025-03-21 14:40:12] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:40:12] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:40:12] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.29 seconds
[2025-03-21 14:40:12] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:40:12] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:40:12] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:40:12] [INFO] [Scanner] Found 43 existing accounts
[2025-03-21 14:40:12] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:40:12] [INFO] [Scanner] Registering user 'admin_user_1742586011_x4djta@example.com' with admin=True
[2025-03-21 14:40:12] [INFO] [Scanner] Successfully registered user 'admin_user_1742586011_x4djta@example.com'
[2025-03-21 14:40:13] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:40:13] [INFO] [Scanner] Found 44 existing accounts
[2025-03-21 14:40:13] [WARNING] [Scanner] User 'admin_user_1742586011_x4djta@example.com' was created with admin privileges
[2025-03-21 14:40:13] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:40:13] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:40:13] [INFO] [core.account_cache] Using cached account: test_user_1742586011_2
[2025-03-21 14:40:13] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:40:13] [INFO] [Scanner] Using cached account: test_user_1742586011_2
[2025-03-21 14:40:14] [INFO] [Scanner] Logging in as user 'test_user_1742586011_x4djta@example.com'
[2025-03-21 14:40:14] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:40:14] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:40:14] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:40:14] [INFO] [core.account_cache] Using cached account: test_user_1742586011_3
[2025-03-21 14:40:14] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:40:14] [INFO] [Scanner] Using cached account: test_user_1742586011_3
[2025-03-21 14:40:15] [INFO] [Scanner] Logging in as user 'test_user_1742586011_x4djta@example.com'
[2025-03-21 14:40:15] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:40:15] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:40:15] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:40:15] [INFO] [core.account_cache] Using cached account: test_user_1742586011_1
[2025-03-21 14:40:15] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:40:15] [INFO] [Scanner] Using cached account: test_user_1742586011_1
[2025-03-21 14:40:15] [INFO] [Scanner] Logging in as user 'test_user_1742586011_x4djta@example.com'
[2025-03-21 14:40:15] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:40:15] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:40:15] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.07 seconds
[2025-03-21 14:40:15] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:40:15] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:40:15] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:40:15] [INFO] [Scanner] Debug endpoint returned a 'users' array with 44 items
[2025-03-21 14:40:15] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:40:15] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321144015.json
[2025-03-21 14:40:15] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:40:15] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:40:15] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:40:15] [INFO] [Scanner] Registering test user: test_user_1742586011_7spmz6
[2025-03-21 14:40:15] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:40:15] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:40:15] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:40:15] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:40:15] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:40:15] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:40:15] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:40:15] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:40:24] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:40:24] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:40:24] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:40:24] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:40:24] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:40:25] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:40:25] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:40:25] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:40:26] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:40:26] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:40:27] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:40:27] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742586027' with admin privileges
[2025-03-21 14:40:27] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742586027'
[2025-03-21 14:40:28] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:40:28] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.78 seconds
[2025-03-21 14:40:28] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:40:28] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:40:28] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:40:28] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:40:28] [INFO] [Scanner] Found 47 existing accounts
[2025-03-21 14:40:28] [INFO] [Scanner] Registering new test user 'test_user_1742586011_pt9fzg' with admin privileges
[2025-03-21 14:40:28] [INFO] [Scanner] Successfully registered test user 'test_user_1742586011_pt9fzg'
[2025-03-21 14:40:28] [INFO] [Scanner] Verifying test user 'test_user_1742586011_pt9fzg' was created
[2025-03-21 14:40:29] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:40:29] [INFO] [Scanner] Found 48 existing accounts
[2025-03-21 14:40:29] [INFO] [Scanner] Verified test user 'test_user_1742586011_pt9fzg' was created successfully
[2025-03-21 14:40:29] [INFO] [Scanner] Logging in as test user 'test_user_1742586011_pt9fzg'
[2025-03-21 14:40:29] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:40:29] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:40:29] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:40:29] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:40:29] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:40:29] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:40:29] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.04 seconds
[2025-03-21 14:40:29] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:40:29] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:40:29] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:40:29] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742586029_standard_zgn3@example.com
[2025-03-21 14:40:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:29] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742586029_standard_zgn3@example.com, status code: 404
[2025-03-21 14:40:30] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742586029_premium_htxt@example.com
[2025-03-21 14:40:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:30] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742586029_premium_htxt@example.com, status code: 404
[2025-03-21 14:40:31] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742586029_admin_seex@example.com
[2025-03-21 14:40:31] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:31] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:31] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:31] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742586029_admin_seex@example.com, status code: 404
[2025-03-21 14:40:32] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:40:32] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:40:32] [INFO] [core.account_cache] Using cached account: test_user_1742586011_2
[2025-03-21 14:40:32] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:40:32] [INFO] [Scanner] Using cached account: test_user_1742586011_2
[2025-03-21 14:40:32] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:40:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:32] [WARNING] [Scanner] Failed to create test account: test_user_1742586011_2, status code: 404
[2025-03-21 14:40:32] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:40:32] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:40:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:32] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:40:32] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:40:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:32] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:40:33] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:40:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:33] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:40:33] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:40:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:33] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:40:34] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:40:34] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:34] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:34] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:34] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:40:34] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:40:34] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:34] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:34] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:34] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:40:35] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:40:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:35] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:40:35] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:40:35] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:35] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:35] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:35] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:40:36] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:40:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:36] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:40:36] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:40:36] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:36] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:36] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:36] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:40:37] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:40:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:37] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:40:37] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:40:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:37] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:40:38] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:40:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:38] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:40:38] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:40:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:38] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:40:39] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:40:39] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:40:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:39] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:40:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:39] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:40:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:40] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:40:40] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:40:40] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:40:40] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:40:40] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:40:40] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:40:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:43] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:40:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:44] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:40:45] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:45] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:45] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:45] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:40:45] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:40:45] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:40:45] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:40:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:48] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:40:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:40:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:40:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:40:54] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:41:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:01] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:41:01] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:41:01] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:41:01] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:41:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:04] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:41:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:12] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:41:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:20] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:41:20] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:41:20] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:41:20] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:41:23] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:23] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:23] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:23] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:41:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:33] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:41:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:43] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:41:43] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:41:43] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:41:43] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:41:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:46] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:41:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:41:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:41:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:41:56] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:42:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:06] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:42:06] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:42:06] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:42:06] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:42:06] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:42:06] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:06] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:06] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:06] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:42:17] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:17] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:17] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:17] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:42:27] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:42:27] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:42:27] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:42:27] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:42:27] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:42:27] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:42:27] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:42:27] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:42:27] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:42:27] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:42:27] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:42:27] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:42:27] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:42:27] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:42:27] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:42:27] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:42:27] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:42:27] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:42:27] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:42:27] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:42:27] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:42:27] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:42:27] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:42:27] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:42:27] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:42:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:42:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:42:27] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:42:27] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:42:27] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 118.17 seconds
[2025-03-21 14:42:27] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:42:27] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:42:27] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:42:27] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:42:27] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:42:27] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:42:27] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:42:27] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:42:27] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:42:27] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:42:27] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NjE0NywiZXhwIjoxNzQ1MTc4MTQ3fQ.eXK46oa4UU8pw-CAyFpGVdSV885UQfQiJOQVjrkpLLk
[2025-03-21 14:42:27] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:42:27] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:42:27] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:42:27] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:42:27] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:42:27] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:42:27 (in 720.0 hours)
[2025-03-21 14:42:27] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:42:27] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:42:27] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:42:27] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:42:27] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:42:27] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:42:27] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:42:27] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:42:27] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:42:27] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:42:27] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:42:27] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:42:27] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:42:27] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:42:27] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:42:27] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:42:27] [INFO] [orchestrator] Scan ID: 20250321144227
[2025-03-21 14:42:27] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:42:27] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321144227.json
[2025-03-21 14:42:27] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321144227.json
[2025-03-21 14:42:27] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321144227.json
[2025-03-21 14:42:27] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:46:57] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:46:57] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:46:57] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:46:57] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:46:57] [WARNING] [main] Failed to create test account: test1742586417@example.com, status: 404
[2025-03-21 14:46:57] [WARNING] [main] Failed to create test account: test1742586418@example.com, status: 404
[2025-03-21 14:46:57] [WARNING] [main] Failed to create test account: test1742586419@example.com, status: 404
[2025-03-21 14:46:57] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:46:57] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vmapi.yaml
[2025-03-21 14:46:57] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:46:57] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:46:57] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:46:57] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:46:57] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:46:57] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:46:57] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:46:57] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:46:57] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:46:57] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:46:57] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:46:57] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:46:57] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:46:57] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:46:57] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:46:57] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:46:57] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:46:57] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:46:57] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:46:57] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:46:57] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:46:57] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:46:57] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:46:57] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:46:57] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:46:57] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:46:57] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:46:57] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:46:57] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:46:57] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:46:57] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:46:57] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:46:57] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:46:57] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:46:57] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:46:57] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:46:57] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:46:57] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:46:57] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:46:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:46:57] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:46:57] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:46:57] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:46:57] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:46:57] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:46:57] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:46:57] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:46:57] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:46:57] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:46:57] [INFO] [core.account_cache] Added new account to cache: test_user_1742586417_1
[2025-03-21 14:46:57] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:46:57] [INFO] [orchestrator] Added test account to cache: test_user_1742586417_1
[2025-03-21 14:46:57] [INFO] [core.account_cache] Added new account to cache: test_user_1742586417_2
[2025-03-21 14:46:57] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:46:57] [INFO] [orchestrator] Added test account to cache: test_user_1742586417_2
[2025-03-21 14:46:57] [INFO] [core.account_cache] Added new account to cache: test_user_1742586417_3
[2025-03-21 14:46:57] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:46:57] [INFO] [orchestrator] Added test account to cache: test_user_1742586417_3
[2025-03-21 14:46:57] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:46:57] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:46:57] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:46:57] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Found 48 users in debug endpoint response
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742585349_8924l4@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742585349_pqanxo from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742585349_pqanxo, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585349, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585365
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585365
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585365, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742585349_h24e9d from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742585349_h24e9d, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742585754_admodu@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742585754_yeii3o
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_yeii3o
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742585754_yeii3o from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742585754_yeii3o, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585754
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585754
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585754, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585769
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585769
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585769, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742585754_x5lhes
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_x5lhes
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742585754_x5lhes from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742585754_x5lhes, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: admin_user_1742586011_x4djta@example.com, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742586011_7spmz6
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_7spmz6
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742586011_7spmz6 from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742586011_7spmz6, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586011
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586011
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586011, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586027
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586027
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586027, status code: 400
[2025-03-21 14:46:57] [INFO] [Scanner] Found credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 14:46:57] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 14:46:57] [INFO] [Scanner] Updated password for user test_user_1742586011_pt9fzg from debug endpoint
[2025-03-21 14:46:57] [INFO] [Scanner] Login failed for user: test_user_1742586011_pt9fzg, status code: 400
[2025-03-21 14:46:57] [INFO] [core.account_cache] Using cached account: test_user_1742586417_1
[2025-03-21 14:46:57] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:46:57] [INFO] [Scanner] Using cached account: test_user_1742586417_1
[2025-03-21 14:46:57] [INFO] [Scanner] Using existing test account: test_user_1742586417_1
[2025-03-21 14:46:57] [INFO] [Scanner] Logging in as user 'test_user_1742586417_1'
[2025-03-21 14:46:57] [INFO] [Scanner] Login payload: {"email": "test_user_1742586417_1", "password": "Test@1742586417_1"}
[2025-03-21 14:46:57] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:46:57] [WARNING] [Scanner] Failed to login as 'test_user_1742586417_1', status code: 400
[2025-03-21 14:46:57] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:46:57] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:46:57] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.33 seconds
[2025-03-21 14:46:57] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:46:57] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:46:57] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:46:57] [INFO] [Scanner] Found 48 existing accounts
[2025-03-21 14:46:57] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:46:57] [INFO] [Scanner] Registering user 'admin_user_1742586417_hfqfln@example.com' with admin=True
[2025-03-21 14:46:57] [INFO] [Scanner] Successfully registered user 'admin_user_1742586417_hfqfln@example.com'
[2025-03-21 14:46:58] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:46:58] [INFO] [Scanner] Found 49 existing accounts
[2025-03-21 14:46:58] [WARNING] [Scanner] User 'admin_user_1742586417_hfqfln@example.com' was created with admin privileges
[2025-03-21 14:46:58] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:46:58] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:46:58] [INFO] [core.account_cache] Using cached account: test_user_1742586417_2
[2025-03-21 14:46:58] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:46:58] [INFO] [Scanner] Using cached account: test_user_1742586417_2
[2025-03-21 14:46:59] [INFO] [Scanner] Logging in as user 'test_user_1742586417_hfqfln@example.com'
[2025-03-21 14:46:59] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:46:59] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:46:59] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:46:59] [INFO] [core.account_cache] Using cached account: test_user_1742586417_3
[2025-03-21 14:46:59] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:46:59] [INFO] [Scanner] Using cached account: test_user_1742586417_3
[2025-03-21 14:47:00] [INFO] [Scanner] Logging in as user 'test_user_1742586417_hfqfln@example.com'
[2025-03-21 14:47:00] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:47:00] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:47:00] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:47:00] [INFO] [core.account_cache] Using cached account: test_user_1742586417_1
[2025-03-21 14:47:00] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:47:00] [INFO] [Scanner] Using cached account: test_user_1742586417_1
[2025-03-21 14:47:00] [INFO] [Scanner] Logging in as user 'test_user_1742586417_hfqfln@example.com'
[2025-03-21 14:47:00] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:47:00] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:47:00] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.06 seconds
[2025-03-21 14:47:00] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:47:00] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:47:00] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:47:00] [INFO] [Scanner] Debug endpoint returned a 'users' array with 49 items
[2025-03-21 14:47:00] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:47:00] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321144700.json
[2025-03-21 14:47:00] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:47:00] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:47:00] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:47:00] [INFO] [Scanner] Registering test user: test_user_1742586417_vkf5q2
[2025-03-21 14:47:00] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:47:00] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:47:00] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:47:00] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:47:00] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:47:00] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:47:00] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:47:00] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:47:09] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:47:09] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:47:09] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:47:09] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:47:09] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:47:10] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:47:10] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:47:10] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:47:11] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:47:11] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:47:12] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:47:12] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742586432' with admin privileges
[2025-03-21 14:47:12] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742586432'
[2025-03-21 14:47:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:47:13] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.81 seconds
[2025-03-21 14:47:13] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:47:13] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:47:13] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:47:13] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:47:13] [INFO] [Scanner] Found 52 existing accounts
[2025-03-21 14:47:13] [INFO] [Scanner] Registering new test user 'test_user_1742586417_tak9qr' with admin privileges
[2025-03-21 14:47:13] [INFO] [Scanner] Successfully registered test user 'test_user_1742586417_tak9qr'
[2025-03-21 14:47:13] [INFO] [Scanner] Verifying test user 'test_user_1742586417_tak9qr' was created
[2025-03-21 14:47:14] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:47:14] [INFO] [Scanner] Found 53 existing accounts
[2025-03-21 14:47:14] [INFO] [Scanner] Verified test user 'test_user_1742586417_tak9qr' was created successfully
[2025-03-21 14:47:14] [INFO] [Scanner] Logging in as test user 'test_user_1742586417_tak9qr'
[2025-03-21 14:47:14] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:47:14] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:47:14] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:47:14] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:47:14] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:47:14] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:47:14] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.06 seconds
[2025-03-21 14:47:14] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:47:14] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:47:14] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:47:14] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742586434_standard_c75m@example.com
[2025-03-21 14:47:14] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:14] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:14] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:14] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742586434_standard_c75m@example.com, status code: 404
[2025-03-21 14:47:15] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742586434_premium_f6qz@example.com
[2025-03-21 14:47:15] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:15] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:15] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:15] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742586434_premium_f6qz@example.com, status code: 404
[2025-03-21 14:47:16] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742586434_admin_jyhf@example.com
[2025-03-21 14:47:16] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:16] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:16] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742586434_admin_jyhf@example.com, status code: 404
[2025-03-21 14:47:17] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:47:17] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:47:17] [INFO] [core.account_cache] Using cached account: test_user_1742586417_2
[2025-03-21 14:47:17] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:47:17] [INFO] [Scanner] Using cached account: test_user_1742586417_2
[2025-03-21 14:47:17] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:47:17] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:17] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:17] [WARNING] [Scanner] Failed to create test account: test_user_1742586417_2, status code: 404
[2025-03-21 14:47:17] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:47:17] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:47:17] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:17] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:17] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:17] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:47:18] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:47:18] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:18] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:18] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:18] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:47:18] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:47:18] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:18] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:18] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:18] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:47:19] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:47:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:19] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:47:19] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:47:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:19] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:47:20] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:47:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:20] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:47:20] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:47:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:20] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:47:21] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:47:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:21] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:47:21] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:47:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:21] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:47:22] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:47:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:22] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:47:22] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:47:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:22] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:47:23] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:47:23] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:23] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:23] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:23] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:47:23] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:47:23] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:23] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:23] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:23] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:47:24] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:47:24] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:24] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:24] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:24] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:47:24] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:47:24] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:47:24] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:24] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:24] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:24] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:47:25] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:25] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:25] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:25] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:47:25] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:25] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:25] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:25] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:47:25] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:47:25] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:47:25] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:47:25] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:47:25] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:47:28] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:28] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:28] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:28] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:47:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:29] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:47:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:30] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:47:30] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:47:30] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:47:30] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:47:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:33] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:47:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:39] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:47:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:44] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:47:44] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:47:44] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:47:44] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:47:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:47] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:47:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:47:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:47:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:47:56] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:48:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:04] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:48:04] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:48:04] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:48:04] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:48:07] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:07] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:07] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:07] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:48:16] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:16] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:16] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:16] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:48:25] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:25] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:25] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:25] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:48:25] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:48:25] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:48:25] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:48:28] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:28] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:28] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:28] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:48:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:38] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:48:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:47] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:48:47] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:48:47] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:48:47] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:48:47] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:48:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:47] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:48:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:48:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:48:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:48:58] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:49:08] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:49:08] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:49:08] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:49:08] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:49:08] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:49:08] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:49:08] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:49:08] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:49:08] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:49:08] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:49:08] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:49:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:49:08] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:49:08] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:49:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:49:08] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:49:08] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:49:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:49:08] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:49:08] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:49:08] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:49:08] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:49:08] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:49:08] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:49:08] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:49:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:49:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:49:08] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:49:08] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:49:08] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 113.70 seconds
[2025-03-21 14:49:08] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:49:08] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:49:08] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:49:08] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:49:08] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:49:08] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:49:08] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:49:08] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:49:08] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:49:08] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:49:08] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NjU0OCwiZXhwIjoxNzQ1MTc4NTQ4fQ._Bd92P9Kc9sDFNxxaXtnKZIgkMxupEgVUMrR6VhGk6s
[2025-03-21 14:49:08] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:49:08] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:49:08] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:49:08] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:49:08] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:49:08] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:49:08 (in 720.0 hours)
[2025-03-21 14:49:08] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:49:08] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:49:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:49:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:49:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:49:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:49:08] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:49:08] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:49:08] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:49:08] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:49:08] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:49:08] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:49:08] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:49:08] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:49:08] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:49:08] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:49:08] [INFO] [orchestrator] Scan ID: 20250321144908
[2025-03-21 14:49:08] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:49:08] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321144908.json
[2025-03-21 14:49:08] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321144908.json
[2025-03-21 14:49:08] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321144908.json
[2025-03-21 14:49:08] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 14:54:30] [INFO] [main] Clearing account cache before scan
[2025-03-21 14:54:30] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:54:30] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:54:30] [INFO] [main] Creating test accounts for scan
[2025-03-21 14:54:30] [WARNING] [main] Failed to create test account: test1742586870@example.com, status: 404
[2025-03-21 14:54:30] [WARNING] [main] Failed to create test account: test1742586871@example.com, status: 404
[2025-03-21 14:54:30] [WARNING] [main] Failed to create test account: test1742586872@example.com, status: 404
[2025-03-21 14:54:30] [INFO] [orchestrator] Starting API security scan
[2025-03-21 14:54:30] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 14:54:30] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 14:54:30] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 14:54:30] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 14:54:30] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 14:54:30] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 14:54:30] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 14:54:30] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 14:54:30] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 14:54:30] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 14:54:30] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:54:30] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:54:30] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 14:54:30] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:54:30] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:54:30] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:54:30] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:54:30] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:54:30] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 14:54:30] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:54:30] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 14:54:30] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 14:54:30] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 14:54:30] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 14:54:30] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:54:30] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:54:30] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:54:30] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 14:54:30] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 14:54:30] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 14:54:30] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 14:54:30] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 14:54:30] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 14:54:30] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 14:54:30] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:54:30] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:54:30] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 14:54:30] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 14:54:30] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 14:54:30] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 14:54:30] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 14:54:30] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 14:54:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:30] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 14:54:30] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 14:54:30] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 14:54:30] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 14:54:30] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 14:54:30] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 14:54:30] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 14:54:30] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 14:54:30] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 14:54:30] [INFO] [core.account_cache] Added new account to cache: test_user_1742586870_1
[2025-03-21 14:54:30] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 14:54:30] [INFO] [orchestrator] Added test account to cache: test_user_1742586870_1
[2025-03-21 14:54:30] [INFO] [core.account_cache] Added new account to cache: test_user_1742586870_2
[2025-03-21 14:54:30] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 14:54:30] [INFO] [orchestrator] Added test account to cache: test_user_1742586870_2
[2025-03-21 14:54:30] [INFO] [core.account_cache] Added new account to cache: test_user_1742586870_3
[2025-03-21 14:54:30] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:54:30] [INFO] [orchestrator] Added test account to cache: test_user_1742586870_3
[2025-03-21 14:54:30] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 14:54:30] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 14:54:30] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 14:54:30] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 14:54:30] [INFO] [Scanner] Found 53 users in debug endpoint response
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 14:54:30] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 14:54:30] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 14:54:30] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 14:54:30] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 14:54:30] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:54:30] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742585349_8924l4@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_pqanxo
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742585349_pqanxo from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742585349_pqanxo, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585349
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585349, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585365
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585365
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585365, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_h24e9d
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742585349_h24e9d from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742585349_h24e9d, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742585754_admodu@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742585754_yeii3o
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_yeii3o
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742585754_yeii3o from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742585754_yeii3o, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585754
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585754
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585754, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585769
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585769
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585769, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742585754_x5lhes
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_x5lhes
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742585754_x5lhes from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742585754_x5lhes, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742586011_x4djta@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742586011_7spmz6
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_7spmz6
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742586011_7spmz6 from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742586011_7spmz6, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586011
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586011
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586011, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586027
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586027
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586027, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742586011_pt9fzg from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742586011_pt9fzg, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: admin_user_1742586417_hfqfln@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586417_hfqfln@example.com
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: admin_user_1742586417_hfqfln@example.com, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742586417_vkf5q2
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586417_vkf5q2
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742586417_vkf5q2 from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742586417_vkf5q2, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586417
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586417
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586417, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586432
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586432
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586432, status code: 400
[2025-03-21 14:54:31] [INFO] [Scanner] Found credentials for user: test_user_1742586417_tak9qr
[2025-03-21 14:54:31] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586417_tak9qr
[2025-03-21 14:54:31] [INFO] [Scanner] Updated password for user test_user_1742586417_tak9qr from debug endpoint
[2025-03-21 14:54:31] [INFO] [Scanner] Login failed for user: test_user_1742586417_tak9qr, status code: 400
[2025-03-21 14:54:31] [INFO] [core.account_cache] Using cached account: test_user_1742586870_1
[2025-03-21 14:54:31] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:54:31] [INFO] [Scanner] Using cached account: test_user_1742586870_1
[2025-03-21 14:54:31] [INFO] [Scanner] Using existing test account: test_user_1742586870_1
[2025-03-21 14:54:31] [INFO] [Scanner] Logging in as user 'test_user_1742586870_1'
[2025-03-21 14:54:31] [INFO] [Scanner] Login payload: {"email": "test_user_1742586870_1", "password": "Test@1742586870_1"}
[2025-03-21 14:54:31] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:54:31] [WARNING] [Scanner] Failed to login as 'test_user_1742586870_1', status code: 400
[2025-03-21 14:54:31] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 14:54:31] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 14:54:31] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.34 seconds
[2025-03-21 14:54:31] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 14:54:31] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 14:54:31] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:54:31] [INFO] [Scanner] Found 53 existing accounts
[2025-03-21 14:54:31] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 14:54:31] [INFO] [Scanner] Registering user 'admin_user_1742586870_d0koe8@example.com' with admin=True
[2025-03-21 14:54:31] [INFO] [Scanner] Successfully registered user 'admin_user_1742586870_d0koe8@example.com'
[2025-03-21 14:54:32] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:54:32] [INFO] [Scanner] Found 54 existing accounts
[2025-03-21 14:54:32] [WARNING] [Scanner] User 'admin_user_1742586870_d0koe8@example.com' was created with admin privileges
[2025-03-21 14:54:32] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 14:54:32] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 14:54:32] [INFO] [core.account_cache] Using cached account: test_user_1742586870_2
[2025-03-21 14:54:32] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:54:32] [INFO] [Scanner] Using cached account: test_user_1742586870_2
[2025-03-21 14:54:33] [INFO] [Scanner] Logging in as user 'test_user_1742586870_d0koe8@example.com'
[2025-03-21 14:54:33] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:54:33] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:54:33] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 14:54:33] [INFO] [core.account_cache] Using cached account: test_user_1742586870_3
[2025-03-21 14:54:33] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:54:33] [INFO] [Scanner] Using cached account: test_user_1742586870_3
[2025-03-21 14:54:34] [INFO] [Scanner] Logging in as user 'test_user_1742586870_d0koe8@example.com'
[2025-03-21 14:54:34] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:54:34] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 14:54:34] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 14:54:34] [INFO] [core.account_cache] Using cached account: test_user_1742586870_1
[2025-03-21 14:54:34] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:54:34] [INFO] [Scanner] Using cached account: test_user_1742586870_1
[2025-03-21 14:54:34] [INFO] [Scanner] Logging in as user 'test_user_1742586870_d0koe8@example.com'
[2025-03-21 14:54:34] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 14:54:34] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 14:54:34] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.09 seconds
[2025-03-21 14:54:34] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 14:54:34] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 14:54:34] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 14:54:34] [INFO] [Scanner] Debug endpoint returned a 'users' array with 54 items
[2025-03-21 14:54:34] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 14:54:34] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321145434.json
[2025-03-21 14:54:34] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 14:54:34] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 14:54:34] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 14:54:34] [INFO] [Scanner] Registering test user: test_user_1742586870_maegke
[2025-03-21 14:54:34] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 14:54:34] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 14:54:34] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 14:54:34] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 14:54:34] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 14:54:34] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 14:54:34] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 14:54:34] [INFO] [Scanner] Using email as user identifier
[2025-03-21 14:54:43] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 14:54:43] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 14:54:43] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 14:54:43] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:54:43] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:54:44] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:54:44] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 14:54:44] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 14:54:45] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 14:54:45] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 14:54:46] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 14:54:46] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742586886' with admin privileges
[2025-03-21 14:54:46] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742586886'
[2025-03-21 14:54:47] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 14:54:47] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.79 seconds
[2025-03-21 14:54:47] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 14:54:47] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 14:54:47] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:54:47] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:54:47] [INFO] [Scanner] Found 57 existing accounts
[2025-03-21 14:54:47] [INFO] [Scanner] Registering new test user 'test_user_1742586870_833zgy' with admin privileges
[2025-03-21 14:54:47] [INFO] [Scanner] Successfully registered test user 'test_user_1742586870_833zgy'
[2025-03-21 14:54:47] [INFO] [Scanner] Verifying test user 'test_user_1742586870_833zgy' was created
[2025-03-21 14:54:48] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 14:54:48] [INFO] [Scanner] Found 58 existing accounts
[2025-03-21 14:54:48] [INFO] [Scanner] Verified test user 'test_user_1742586870_833zgy' was created successfully
[2025-03-21 14:54:48] [INFO] [Scanner] Logging in as test user 'test_user_1742586870_833zgy'
[2025-03-21 14:54:48] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 14:54:48] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 14:54:48] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 14:54:48] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 14:54:48] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 14:54:48] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 14:54:48] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.05 seconds
[2025-03-21 14:54:48] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 14:54:48] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 14:54:48] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 14:54:48] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742586888_standard_wrxu@example.com
[2025-03-21 14:54:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:48] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742586888_standard_wrxu@example.com, status code: 404
[2025-03-21 14:54:49] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742586888_premium_84h1@example.com
[2025-03-21 14:54:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:49] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742586888_premium_84h1@example.com, status code: 404
[2025-03-21 14:54:50] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742586888_admin_vhm2@example.com
[2025-03-21 14:54:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:50] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742586888_admin_vhm2@example.com, status code: 404
[2025-03-21 14:54:51] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 14:54:51] [INFO] [Scanner] Testing basic account creation
[2025-03-21 14:54:51] [INFO] [core.account_cache] Using cached account: test_user_1742586870_2
[2025-03-21 14:54:51] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 14:54:51] [INFO] [Scanner] Using cached account: test_user_1742586870_2
[2025-03-21 14:54:51] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 14:54:51] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:51] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:51] [WARNING] [Scanner] Failed to create test account: test_user_1742586870_2, status code: 404
[2025-03-21 14:54:51] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 14:54:51] [INFO] [Scanner] Testing: Empty username
[2025-03-21 14:54:51] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:51] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:51] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:51] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 14:54:51] [INFO] [Scanner] Testing: Very short username
[2025-03-21 14:54:51] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:51] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:51] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:51] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 14:54:52] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 14:54:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:52] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 14:54:52] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 14:54:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:52] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 14:54:53] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 14:54:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:53] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 14:54:53] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 14:54:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:53] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 14:54:54] [INFO] [Scanner] Testing: Empty email
[2025-03-21 14:54:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:54] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 14:54:54] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 14:54:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:54] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 14:54:55] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 14:54:55] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:55] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:55] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:55] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 14:54:55] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 14:54:55] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:55] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:55] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:55] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 14:54:56] [INFO] [Scanner] Testing: Empty password
[2025-03-21 14:54:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:56] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 14:54:56] [INFO] [Scanner] Testing: Short password
[2025-03-21 14:54:56] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:56] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:56] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:56] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 14:54:57] [INFO] [Scanner] Testing: Common password
[2025-03-21 14:54:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:57] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 14:54:57] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 14:54:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:57] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 14:54:58] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 14:54:58] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 14:54:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:58] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 14:54:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:58] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 14:54:59] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:54:59] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:54:59] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:54:59] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 14:54:59] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:54:59] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 14:54:59] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 14:54:59] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 14:54:59] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 14:55:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:02] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:55:03] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:03] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:03] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:03] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:55:04] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:04] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:04] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:04] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:55:04] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:55:04] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 14:55:04] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 14:55:07] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:07] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:07] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:07] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:55:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:12] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:55:18] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:18] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:18] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:18] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:55:18] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:55:18] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 14:55:18] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 14:55:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:21] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:55:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:30] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:55:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:37] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:55:37] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:55:37] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 14:55:37] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 14:55:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:40] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:55:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:49] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:55:58] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:55:58] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:55:58] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:55:58] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:55:58] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:55:58] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 14:55:58] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 14:56:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:01] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 14:56:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:11] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 14:56:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:22] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 14:56:22] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:56:22] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 14:56:22] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 14:56:22] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 14:56:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:22] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 14:56:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:32] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 14:56:42] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 14:56:42] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 14:56:42] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 14:56:42] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 14:56:42] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 14:56:42] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 14:56:42] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 14:56:42] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:56:42] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:56:42] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:56:42] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 14:56:42] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:56:42] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 14:56:42] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:56:42] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:56:42] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 14:56:42] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 14:56:42] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:56:42] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 14:56:42] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] No token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 14:56:42] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 14:56:42] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 14:56:42] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 14:56:42] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 14:56:42] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 14:56:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 14:56:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 14:56:42] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 14:56:42] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 14:56:42] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 114.66 seconds
[2025-03-21 14:56:42] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 14:56:42] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 14:56:42] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 14:56:42] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 14:56:42] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 14:56:42] [INFO] [Scanner] User info endpoint: /
[2025-03-21 14:56:42] [INFO] [Scanner] Debug mode: True
[2025-03-21 14:56:42] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 14:56:42] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 14:56:42] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 14:56:42] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NzAwMiwiZXhwIjoxNzQ1MTc5MDAyfQ.xBcaUhuZDYxVrKurrnCnCW1NVqluSJdwGAs4qpJAEk8
[2025-03-21 14:56:42] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 14:56:42] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 14:56:42] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 14:56:42] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 14:56:42] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 14:56:42] [INFO] [Scanner] JWT Expiration: 2025-04-20 14:56:42 (in 720.0 hours)
[2025-03-21 14:56:42] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 14:56:42] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 14:56:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 14:56:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 14:56:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 14:56:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 14:56:42] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 14:56:42] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 14:56:42] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 14:56:42] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 14:56:42] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 14:56:42] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 14:56:42] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 14:56:42] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 14:56:42] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 14:56:42] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:56:42] [INFO] [orchestrator] Scan ID: 20250321145642
[2025-03-21 14:56:42] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 14:56:42] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321145642.json
[2025-03-21 14:56:42] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321145642.json
[2025-03-21 14:56:42] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321145642.json
[2025-03-21 14:56:42] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 15:06:20] [INFO] [main] Clearing account cache before scan
[2025-03-21 15:06:20] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 15:06:20] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 15:06:20] [INFO] [main] Creating test accounts for scan
[2025-03-21 15:06:20] [WARNING] [main] Failed to create test account: test1742587580@example.com, status: 404
[2025-03-21 15:06:20] [WARNING] [main] Failed to create test account: test1742587581@example.com, status: 404
[2025-03-21 15:06:20] [WARNING] [main] Failed to create test account: test1742587582@example.com, status: 404
[2025-03-21 15:06:20] [INFO] [orchestrator] Starting API security scan
[2025-03-21 15:06:20] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi.yaml
[2025-03-21 15:06:20] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 15:06:20] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 15:06:20] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 15:06:20] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 15:06:20] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 15:06:20] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 15:06:20] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 15:06:20] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 15:06:20] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 15:06:20] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 15:06:20] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:06:20] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 15:06:20] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:06:20] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 15:06:20] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 15:06:20] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 15:06:20] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:06:20] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 15:06:20] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:06:20] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 15:06:20] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 15:06:20] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 15:06:20] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 15:06:20] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:06:20] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:06:20] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 15:06:20] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 15:06:20] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 15:06:20] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:06:20] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 15:06:20] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 15:06:20] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:06:20] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 15:06:20] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 15:06:20] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 15:06:20] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 15:06:20] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 15:06:20] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 15:06:20] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:06:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:20] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 15:06:20] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 15:06:20] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:06:20] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 15:06:20] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:06:20] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 15:06:20] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 15:06:20] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 15:06:20] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 15:06:20] [INFO] [core.account_cache] Added new account to cache: test_user_1742587580_1
[2025-03-21 15:06:20] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 15:06:20] [INFO] [orchestrator] Added test account to cache: test_user_1742587580_1
[2025-03-21 15:06:20] [INFO] [core.account_cache] Added new account to cache: test_user_1742587580_2
[2025-03-21 15:06:20] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 15:06:20] [INFO] [orchestrator] Added test account to cache: test_user_1742587580_2
[2025-03-21 15:06:20] [INFO] [core.account_cache] Added new account to cache: test_user_1742587580_3
[2025-03-21 15:06:20] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:06:20] [INFO] [orchestrator] Added test account to cache: test_user_1742587580_3
[2025-03-21 15:06:20] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 15:06:20] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 15:06:20] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 15:06:20] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Found 58 users in debug endpoint response
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742585349_8924l4@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742585349_pqanxo
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_pqanxo
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742585349_pqanxo from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742585349_pqanxo, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585349
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585349
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585349, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585365
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585365
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585365, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742585349_h24e9d
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_h24e9d
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742585349_h24e9d from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742585349_h24e9d, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742585754_admodu@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742585754_yeii3o
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_yeii3o
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742585754_yeii3o from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742585754_yeii3o, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585754
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585754
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585754, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585769
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585769
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585769, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742585754_x5lhes
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_x5lhes
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742585754_x5lhes from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742585754_x5lhes, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742586011_x4djta@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742586011_7spmz6
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_7spmz6
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742586011_7spmz6 from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742586011_7spmz6, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586011
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586011
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586011, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586027
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586027
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586027, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742586011_pt9fzg from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742586011_pt9fzg, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742586417_hfqfln@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586417_hfqfln@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742586417_hfqfln@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742586417_vkf5q2
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586417_vkf5q2
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742586417_vkf5q2 from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742586417_vkf5q2, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586417
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586417
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586417, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586432
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586432
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586432, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742586417_tak9qr
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586417_tak9qr
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742586417_tak9qr from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742586417_tak9qr, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: admin_user_1742586870_d0koe8@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586870_d0koe8@example.com
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: admin_user_1742586870_d0koe8@example.com, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742586870_maegke
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586870_maegke
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742586870_maegke from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742586870_maegke, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586870
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586870
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586870, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586886
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586886
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586886, status code: 400
[2025-03-21 15:06:20] [INFO] [Scanner] Found credentials for user: test_user_1742586870_833zgy
[2025-03-21 15:06:20] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586870_833zgy
[2025-03-21 15:06:20] [INFO] [Scanner] Updated password for user test_user_1742586870_833zgy from debug endpoint
[2025-03-21 15:06:20] [INFO] [Scanner] Login failed for user: test_user_1742586870_833zgy, status code: 400
[2025-03-21 15:06:20] [INFO] [core.account_cache] Using cached account: test_user_1742587580_1
[2025-03-21 15:06:20] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:06:20] [INFO] [Scanner] Using cached account: test_user_1742587580_1
[2025-03-21 15:06:20] [INFO] [Scanner] Using existing test account: test_user_1742587580_1
[2025-03-21 15:06:20] [INFO] [Scanner] Logging in as user 'test_user_1742587580_1'
[2025-03-21 15:06:20] [INFO] [Scanner] Login payload: {"email": "test_user_1742587580_1", "password": "Test@1742587580_1"}
[2025-03-21 15:06:20] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 15:06:20] [WARNING] [Scanner] Failed to login as 'test_user_1742587580_1', status code: 400
[2025-03-21 15:06:20] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 15:06:20] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 15:06:20] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.41 seconds
[2025-03-21 15:06:20] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 15:06:20] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 15:06:20] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:06:20] [INFO] [Scanner] Found 58 existing accounts
[2025-03-21 15:06:20] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 15:06:20] [INFO] [Scanner] Registering user 'admin_user_1742587580_2hi91r@example.com' with admin=True
[2025-03-21 15:06:20] [INFO] [Scanner] Successfully registered user 'admin_user_1742587580_2hi91r@example.com'
[2025-03-21 15:06:21] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:06:21] [INFO] [Scanner] Found 59 existing accounts
[2025-03-21 15:06:21] [WARNING] [Scanner] User 'admin_user_1742587580_2hi91r@example.com' was created with admin privileges
[2025-03-21 15:06:21] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 15:06:21] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 15:06:21] [INFO] [core.account_cache] Using cached account: test_user_1742587580_2
[2025-03-21 15:06:21] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:06:21] [INFO] [Scanner] Using cached account: test_user_1742587580_2
[2025-03-21 15:06:22] [INFO] [Scanner] Logging in as user 'test_user_1742587580_2hi91r@example.com'
[2025-03-21 15:06:22] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 15:06:22] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 15:06:22] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 15:06:22] [INFO] [core.account_cache] Using cached account: test_user_1742587580_3
[2025-03-21 15:06:22] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:06:22] [INFO] [Scanner] Using cached account: test_user_1742587580_3
[2025-03-21 15:06:23] [INFO] [Scanner] Logging in as user 'test_user_1742587580_2hi91r@example.com'
[2025-03-21 15:06:23] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 15:06:23] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 15:06:23] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 15:06:23] [INFO] [core.account_cache] Using cached account: test_user_1742587580_1
[2025-03-21 15:06:23] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:06:23] [INFO] [Scanner] Using cached account: test_user_1742587580_1
[2025-03-21 15:06:23] [INFO] [Scanner] Logging in as user 'test_user_1742587580_2hi91r@example.com'
[2025-03-21 15:06:23] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 15:06:23] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 15:06:23] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.06 seconds
[2025-03-21 15:06:23] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 15:06:23] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 15:06:23] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 15:06:23] [INFO] [Scanner] Debug endpoint returned a 'users' array with 59 items
[2025-03-21 15:06:23] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 15:06:23] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321150623.json
[2025-03-21 15:06:23] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 15:06:23] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 15:06:23] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 15:06:23] [INFO] [Scanner] Registering test user: test_user_1742587580_462ugh
[2025-03-21 15:06:23] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 15:06:23] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 15:06:23] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 15:06:23] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 15:06:23] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 15:06:23] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 15:06:23] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 15:06:23] [INFO] [Scanner] Using email as user identifier
[2025-03-21 15:06:32] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 15:06:32] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 15:06:32] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 15:06:32] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 15:06:33] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 15:06:33] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 15:06:34] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 15:06:34] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 15:06:34] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 15:06:35] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 15:06:35] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 15:06:35] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742587595' with admin privileges
[2025-03-21 15:06:35] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742587595'
[2025-03-21 15:06:36] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 15:06:36] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.77 seconds
[2025-03-21 15:06:36] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 15:06:36] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 15:06:36] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 15:06:36] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:06:36] [INFO] [Scanner] Found 62 existing accounts
[2025-03-21 15:06:36] [INFO] [Scanner] Registering new test user 'test_user_1742587580_atk66m' with admin privileges
[2025-03-21 15:06:36] [INFO] [Scanner] Successfully registered test user 'test_user_1742587580_atk66m'
[2025-03-21 15:06:36] [INFO] [Scanner] Verifying test user 'test_user_1742587580_atk66m' was created
[2025-03-21 15:06:37] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:06:37] [INFO] [Scanner] Found 63 existing accounts
[2025-03-21 15:06:37] [INFO] [Scanner] Verified test user 'test_user_1742587580_atk66m' was created successfully
[2025-03-21 15:06:37] [INFO] [Scanner] Logging in as test user 'test_user_1742587580_atk66m'
[2025-03-21 15:06:37] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 15:06:37] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 15:06:37] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 15:06:37] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 15:06:37] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 15:06:37] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 15:06:37] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.05 seconds
[2025-03-21 15:06:37] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 15:06:37] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 15:06:37] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 15:06:37] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742587597_standard_ypp7@example.com
[2025-03-21 15:06:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:37] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742587597_standard_ypp7@example.com, status code: 404
[2025-03-21 15:06:38] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742587597_premium_wsqj@example.com
[2025-03-21 15:06:38] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:38] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:38] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:38] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742587597_premium_wsqj@example.com, status code: 404
[2025-03-21 15:06:39] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742587597_admin_67m6@example.com
[2025-03-21 15:06:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:39] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742587597_admin_67m6@example.com, status code: 404
[2025-03-21 15:06:40] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 15:06:40] [INFO] [Scanner] Testing basic account creation
[2025-03-21 15:06:40] [INFO] [core.account_cache] Using cached account: test_user_1742587580_2
[2025-03-21 15:06:40] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:06:40] [INFO] [Scanner] Using cached account: test_user_1742587580_2
[2025-03-21 15:06:40] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 15:06:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:40] [WARNING] [Scanner] Failed to create test account: test_user_1742587580_2, status code: 404
[2025-03-21 15:06:40] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 15:06:40] [INFO] [Scanner] Testing: Empty username
[2025-03-21 15:06:40] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:40] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:40] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:40] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 15:06:41] [INFO] [Scanner] Testing: Very short username
[2025-03-21 15:06:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:41] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 15:06:41] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 15:06:41] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:41] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:41] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:41] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 15:06:42] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 15:06:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:42] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 15:06:42] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 15:06:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:42] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 15:06:43] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 15:06:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:43] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 15:06:43] [INFO] [Scanner] Testing: Empty email
[2025-03-21 15:06:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:43] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 15:06:44] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 15:06:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:44] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 15:06:44] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 15:06:44] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:44] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:44] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:44] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 15:06:45] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 15:06:45] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:45] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:45] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:45] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 15:06:45] [INFO] [Scanner] Testing: Empty password
[2025-03-21 15:06:45] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:45] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:45] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:45] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 15:06:46] [INFO] [Scanner] Testing: Short password
[2025-03-21 15:06:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:46] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 15:06:46] [INFO] [Scanner] Testing: Common password
[2025-03-21 15:06:46] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:46] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:46] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:46] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 15:06:47] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 15:06:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:47] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 15:06:47] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 15:06:47] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 15:06:47] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:47] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:47] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:47] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 15:06:48] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:48] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:48] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:48] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 15:06:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:49] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 15:06:49] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:06:49] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 15:06:49] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 15:06:49] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 15:06:49] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 15:06:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:52] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:06:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:53] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:06:54] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:54] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:54] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:54] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:06:54] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:06:54] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 15:06:54] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 15:06:57] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:06:57] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:06:57] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:06:57] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:07:03] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:03] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:03] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:03] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:07:08] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:08] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:08] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:08] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:07:08] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:07:08] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 15:07:08] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 15:07:11] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:11] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:11] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:11] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:07:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:19] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:07:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:27] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:07:27] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:07:27] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 15:07:27] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 15:07:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:30] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:07:39] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:39] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:39] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:39] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:07:49] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:49] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:49] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:49] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:07:49] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:07:49] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 15:07:49] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 15:07:52] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:07:52] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:07:52] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:07:52] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:08:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:02] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:08:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:12] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:08:12] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:08:12] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 15:08:12] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 15:08:12] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 15:08:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:12] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 15:08:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:22] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 15:08:32] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:08:32] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 15:08:32] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 15:08:32] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 15:08:32] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 15:08:32] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 15:08:32] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 15:08:32] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 15:08:32] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 15:08:32] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 15:08:32] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 15:08:32] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:08:32] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 15:08:32] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 15:08:32] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:08:32] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 15:08:32] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 15:08:32] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:08:32] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 15:08:32] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:08:32] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 15:08:32] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:08:32] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 15:08:32] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 15:08:32] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 15:08:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:08:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:08:32] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 15:08:32] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 15:08:32] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 114.51 seconds
[2025-03-21 15:08:32] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 15:08:32] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 15:08:32] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 15:08:32] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 15:08:32] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 15:08:32] [INFO] [Scanner] User info endpoint: /
[2025-03-21 15:08:32] [INFO] [Scanner] Debug mode: True
[2025-03-21 15:08:32] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 15:08:32] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 15:08:32] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 15:08:32] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4NzcxMiwiZXhwIjoxNzQ1MTc5NzEyfQ.jLMrtIMjJyBU5XkV5wyfJLh4eyppQ47J1LgJBBFaTJQ
[2025-03-21 15:08:32] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 15:08:32] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 15:08:32] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 15:08:32] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 15:08:32] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 15:08:32] [INFO] [Scanner] JWT Expiration: 2025-04-20 15:08:32 (in 720.0 hours)
[2025-03-21 15:08:32] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 15:08:32] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 15:08:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 15:08:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 15:08:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 15:08:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 15:08:32] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 15:08:32] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 15:08:32] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 15:08:32] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 15:08:32] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 15:08:32] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 15:08:32] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 15:08:32] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 15:08:32] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 15:08:32] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 15:08:32] [INFO] [orchestrator] Scan ID: 20250321150832
[2025-03-21 15:08:32] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 15:08:32] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321150832.json
[2025-03-21 15:08:32] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321150832.json
[2025-03-21 15:08:32] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321150832.json
[2025-03-21 15:08:32] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
[2025-03-21 15:14:01] [INFO] [main] Clearing account cache before scan
[2025-03-21 15:14:01] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 15:14:01] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 15:14:01] [INFO] [main] Creating test accounts for scan
[2025-03-21 15:14:01] [WARNING] [main] Failed to create test account: test1742588041@example.com, status: 404
[2025-03-21 15:14:01] [WARNING] [main] Failed to create test account: test1742588042@example.com, status: 404
[2025-03-21 15:14:01] [WARNING] [main] Failed to create test account: test1742588043@example.com, status: 404
[2025-03-21 15:14:01] [INFO] [orchestrator] Starting API security scan
[2025-03-21 15:14:01] [INFO] [orchestrator] Loading configuration from /Users/rvance/Documents/scannerapi/configs/vampi_beta.yaml
[2025-03-21 15:14:01] [INFO] [orchestrator] Loading OpenAPI specification from /Users/rvance/Documents/scannerapi/swagger/openapi3.yml
[2025-03-21 15:14:01] [INFO] [openapi] Successfully validated OpenAPI 3.0.1 specification
[2025-03-21 15:14:01] [INFO] [openapi] Extracted 1 server URLs from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [openapi] Extracted 14 endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [config] Updating configuration with OpenAPI specification data
[2025-03-21 15:14:01] [INFO] [config] Using server URL from OpenAPI spec: http://localhost:5002
[2025-03-21 15:14:01] [INFO] [config] Configuration updated with 14 endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [orchestrator] Successfully loaded OpenAPI specification with 14 endpoints
[2025-03-21 15:14:01] [INFO] [orchestrator] Applying URL override: http://localhost:5002
[2025-03-21 15:14:01] [INFO] [orchestrator] URL override applied successfully
[2025-03-21 15:14:01] [INFO] [orchestrator] Configuration loaded and validated successfully
[2025-03-21 15:14:01] [INFO] [orchestrator] Discovering scanner modules
[2025-03-21 15:14:01] [INFO] [orchestrator] SQL injection scanner is disabled via --sqlintensity none flag, skipping execution
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 15:14:01] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:14:01] [INFO] [Scanner] Using refresh token endpoint: /users/v1/refresh
[2025-03-21 15:14:01] [INFO] [Scanner] Using user info endpoint: /me
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: broken_authentication
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:14:01] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 15:14:01] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 15:14:01] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 15:14:01] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:14:01] [INFO] [Scanner] Using admin endpoint: /admin
[2025-03-21 15:14:01] [INFO] [Scanner] Using user endpoint: /users/me
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: broken_access_control
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:14:01] [INFO] [openapi] Found register endpoint: /users/v1/register (Score: 165, Reasons: method_match,operation_id_contains_register,path_contains_/register,path_segment_register,description_contains_register,description_exact_phrase_register,summary_contains_register,summary_exact_phrase_register,path_contains_user)
[2025-03-21 15:14:01] [INFO] [openapi] Found debug endpoint: /users/v1/_debug (Score: 90, Reasons: method_match,operation_id_contains_debug,path_contains_/_debug)
[2025-03-21 15:14:01] [INFO] [openapi] Found login endpoint: /users/v1/login (Score: 155, Reasons: method_match,operation_id_contains_login,path_contains_/login,path_segment_login,description_contains_login,description_exact_phrase_login,summary_contains_login,summary_exact_phrase_login)
[2025-03-21 15:14:01] [INFO] [Scanner] Found user endpoint: /users/v1/{username}
[2025-03-21 15:14:01] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:14:01] [INFO] [Scanner] Using user endpoint: /users/v1/{username}
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: excessive_data_exposure
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:14:01] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [Scanner] Found create user endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Found update user endpoint: /users/v1/{username}/email
[2025-03-21 15:14:01] [INFO] [Scanner] Found get user endpoint: /users/v1/{username}
[2025-03-21 15:14:01] [INFO] [Scanner] Using create endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Using update endpoint: /users/v1/{username}/email
[2025-03-21 15:14:01] [INFO] [Scanner] Using get endpoint: /users/v1/{username}
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: mass_assignment
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] Found 14 endpoints in OpenAPI specification
[2025-03-21 15:14:01] [INFO] [Scanner] Found registration endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Found login endpoint: /users/v1/login
[2025-03-21 15:14:01] [INFO] [Scanner] Found password change endpoint: /users/v1/{username}/password
[2025-03-21 15:14:01] [INFO] [Scanner] Found debug endpoint: /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [Scanner] Using debug endpoint: /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:14:01] [INFO] [Scanner] Using password change endpoint: /users/v1/{username}/password
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: unauthorized_password_change
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 15:14:01] [INFO] [Scanner] Using endpoint: /api/users
[2025-03-21 15:14:01] [INFO] [Scanner] Using debug endpoint: /auth/check
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /auth/sign-up
[2025-03-21 15:14:01] [INFO] [Scanner] Using login endpoint: /auth/sign-in
[2025-03-21 15:14:01] [INFO] [Scanner] Using password change endpoint: /users/me/password
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: unrestricted_account_creation
[2025-03-21 15:14:01] [INFO] [orchestrator] Scanner 'regex_dos' is disabled, skipping
[2025-03-21 15:14:01] [INFO] [Scanner] Fallback endpoints disabled - only testing endpoints from OpenAPI specification
[2025-03-21 15:14:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:01] [INFO] [Scanner] Debug mode enabled - simulating vulnerabilities
[2025-03-21 15:14:01] [INFO] [Scanner] No OpenAPI data available for endpoint extraction
[2025-03-21 15:14:01] [INFO] [Scanner] Using login endpoint: /users/v1/login
[2025-03-21 15:14:01] [INFO] [Scanner] Using user info endpoint: /
[2025-03-21 15:14:01] [INFO] [Scanner] Using register endpoint: /users/v1/register
[2025-03-21 15:14:01] [INFO] [orchestrator] Loaded scanner module: jwt_vulnerabilities
[2025-03-21 15:14:01] [INFO] [orchestrator] Clearing account cache before scan
[2025-03-21 15:14:01] [INFO] [core.account_cache] Saved 0 accounts to cache
[2025-03-21 15:14:01] [INFO] [core.account_cache] Account cache cleared
[2025-03-21 15:14:01] [INFO] [core.account_cache] Added new account to cache: test_user_1742588041_1
[2025-03-21 15:14:01] [INFO] [core.account_cache] Saved 1 accounts to cache
[2025-03-21 15:14:01] [INFO] [orchestrator] Added test account to cache: test_user_1742588041_1
[2025-03-21 15:14:01] [INFO] [core.account_cache] Added new account to cache: test_user_1742588041_2
[2025-03-21 15:14:01] [INFO] [core.account_cache] Saved 2 accounts to cache
[2025-03-21 15:14:01] [INFO] [orchestrator] Added test account to cache: test_user_1742588041_2
[2025-03-21 15:14:01] [INFO] [core.account_cache] Added new account to cache: test_user_1742588041_3
[2025-03-21 15:14:01] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:14:01] [INFO] [orchestrator] Added test account to cache: test_user_1742588041_3
[2025-03-21 15:14:01] [INFO] [orchestrator] Initialized account cache with 3 test accounts
[2025-03-21 15:14:01] [INFO] [orchestrator] Starting scanner: broken_authentication
[2025-03-21 15:14:01] [INFO] [Scanner] Starting broken authentication and session management scanner
[2025-03-21 15:14:01] [INFO] [Scanner] Testing for exposed credentials via debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Found 63 users in debug endpoint response
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: name1
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: name1
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: name1, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: name2
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: name2
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: name2, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742576297_dzppsu@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742576297_dzppsu@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_iv1ivm
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742576297_iv1ivm from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742576297_iv1ivm, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742576297
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742576297
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742576297, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742580572
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742580572
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742580572, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742576297_gv1d1v
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742576297_gv1d1v from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742576297_gv1d1v, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742582439_yr1fb4@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742582439_yr1fb4@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_9qqx2p
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742582439_9qqx2p from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742582439_9qqx2p, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742582439
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742582439
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742582439, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742582453
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742582453
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742582453, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742582439_arp93z
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742582439_arp93z
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742582439_arp93z from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742582439_arp93z, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583269_2176iq@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742583269_2176iq@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742583269_lyh12f
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_lyh12f
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742583269_lyh12f from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742583269_lyh12f, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583269
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583269
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583269, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583284
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583284
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583284, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742583269_cndaj7
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583269_cndaj7
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742583269_cndaj7 from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742583269_cndaj7, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742583759_2xvv2y@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742583759_2xvv2y@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742583759_pbimoj
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_pbimoj
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742583759_pbimoj from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742583759_pbimoj, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742583759
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742583759
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742583759, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742583774
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742583774
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742583774, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742583759_i1pcuz
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742583759_i1pcuz from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742583759_i1pcuz, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584401_xhk2x0@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742584401_xhk2x0@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742584401_s334o5
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_s334o5
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742584401_s334o5 from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742584401_s334o5, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584401
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584401
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584401, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742584417
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742584417
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742584417, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742584401_1obpt6
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584401_1obpt6
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742584401_1obpt6 from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742584401_1obpt6, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742584996_t97cji@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742584996_t97cji@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742584996_571j6d
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_571j6d
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742584996_571j6d from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742584996_571j6d, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742584996
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742584996
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742584996, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585011
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585011
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585011, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742584996_4xqs5x
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742584996_4xqs5x from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742584996_4xqs5x, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585349_8924l4@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742585349_8924l4@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742585349_pqanxo
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_pqanxo
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742585349_pqanxo from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742585349_pqanxo, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585349
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585349
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585349, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585365
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585365
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585365, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742585349_h24e9d
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585349_h24e9d
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742585349_h24e9d from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742585349_h24e9d, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742585754_admodu@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742585754_admodu@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742585754_yeii3o
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_yeii3o
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742585754_yeii3o from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742585754_yeii3o, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742585754
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742585754
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742585754, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742585769
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742585769
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742585769, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742585754_x5lhes
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742585754_x5lhes
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742585754_x5lhes from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742585754_x5lhes, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586011_x4djta@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742586011_x4djta@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742586011_7spmz6
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_7spmz6
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742586011_7spmz6 from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742586011_7spmz6, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586011
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586011
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586011, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586027
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586027
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586027, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586011_pt9fzg
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742586011_pt9fzg from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742586011_pt9fzg, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742586417_hfqfln@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586417_hfqfln@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742586417_hfqfln@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742586417_vkf5q2
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586417_vkf5q2
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742586417_vkf5q2 from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742586417_vkf5q2, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586417
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586417
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586417, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586432
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586432
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586432, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742586417_tak9qr
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586417_tak9qr
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742586417_tak9qr from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742586417_tak9qr, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742586870_d0koe8@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742586870_d0koe8@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742586870_d0koe8@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742586870_maegke
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586870_maegke
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742586870_maegke from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742586870_maegke, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742586870
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742586870
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742586870, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742586886
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742586886
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742586886, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742586870_833zgy
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742586870_833zgy
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742586870_833zgy from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742586870_833zgy, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: admin_user_1742587580_2hi91r@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: admin_user_1742587580_2hi91r@example.com
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: admin_user_1742587580_2hi91r@example.com, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742587580_462ugh
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742587580_462ugh
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742587580_462ugh from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742587580_462ugh, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_assignment_1742587580
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_assignment_1742587580
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_assignment_1742587580, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_mass_reg_1742587595
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_mass_reg_1742587595
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_mass_reg_1742587595, status code: 400
[2025-03-21 15:14:01] [INFO] [Scanner] Found credentials for user: test_user_1742587580_atk66m
[2025-03-21 15:14:01] [INFO] [Scanner] Attempting to login with credentials for user: test_user_1742587580_atk66m
[2025-03-21 15:14:01] [INFO] [Scanner] Updated password for user test_user_1742587580_atk66m from debug endpoint
[2025-03-21 15:14:01] [INFO] [Scanner] Login failed for user: test_user_1742587580_atk66m, status code: 400
[2025-03-21 15:14:01] [INFO] [core.account_cache] Using cached account: test_user_1742588041_1
[2025-03-21 15:14:01] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:14:01] [INFO] [Scanner] Using cached account: test_user_1742588041_1
[2025-03-21 15:14:01] [INFO] [Scanner] Using existing test account: test_user_1742588041_1
[2025-03-21 15:14:01] [INFO] [Scanner] Logging in as user 'test_user_1742588041_1'
[2025-03-21 15:14:01] [INFO] [Scanner] Login payload: {"email": "test_user_1742588041_1", "password": "Test@1742588041_1"}
[2025-03-21 15:14:01] [INFO] [Scanner] Login response: 400 - { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 15:14:01] [WARNING] [Scanner] Failed to login as 'test_user_1742588041_1', status code: 400
[2025-03-21 15:14:01] [WARNING] [Scanner] Response body: { "status": "fail", "message": "'username' is a required property"}
[2025-03-21 15:14:01] [WARNING] [Scanner] Failed to obtain access token, skipping token-related tests
[2025-03-21 15:14:01] [INFO] [orchestrator] Completed scanner 'broken_authentication' in 0.44 seconds
[2025-03-21 15:14:01] [INFO] [orchestrator] Starting scanner: broken_access_control
[2025-03-21 15:14:01] [INFO] [Scanner] Starting broken access control scanner
[2025-03-21 15:14:01] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:14:01] [INFO] [Scanner] Found 63 existing accounts
[2025-03-21 15:14:01] [INFO] [Scanner] Testing for privilege escalation during registration
[2025-03-21 15:14:01] [INFO] [Scanner] Registering user 'admin_user_1742588041_gt2yx9@example.com' with admin=True
[2025-03-21 15:14:01] [INFO] [Scanner] Successfully registered user 'admin_user_1742588041_gt2yx9@example.com'
[2025-03-21 15:14:02] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:14:02] [INFO] [Scanner] Found 64 existing accounts
[2025-03-21 15:14:02] [WARNING] [Scanner] User 'admin_user_1742588041_gt2yx9@example.com' was created with admin privileges
[2025-03-21 15:14:02] [INFO] [Scanner] Found HIGH severity vulnerability: Privilege Escalation During Registration at /users/v1/register
[2025-03-21 15:14:02] [INFO] [Scanner] Testing for unauthorized access to admin resources
[2025-03-21 15:14:02] [INFO] [core.account_cache] Using cached account: test_user_1742588041_2
[2025-03-21 15:14:02] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:14:02] [INFO] [Scanner] Using cached account: test_user_1742588041_2
[2025-03-21 15:14:03] [INFO] [Scanner] Logging in as user 'test_user_1742588041_gt2yx9@example.com'
[2025-03-21 15:14:03] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 15:14:03] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 15:14:03] [INFO] [Scanner] Testing for horizontal privilege escalation
[2025-03-21 15:14:03] [INFO] [core.account_cache] Using cached account: test_user_1742588041_3
[2025-03-21 15:14:03] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:14:03] [INFO] [Scanner] Using cached account: test_user_1742588041_3
[2025-03-21 15:14:04] [INFO] [Scanner] Logging in as user 'test_user_1742588041_gt2yx9@example.com'
[2025-03-21 15:14:04] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 15:14:04] [INFO] [Scanner] Failed to login as regular user, skipping test
[2025-03-21 15:14:04] [INFO] [Scanner] Testing for JWT manipulation and forged token vulnerabilities
[2025-03-21 15:14:04] [INFO] [core.account_cache] Using cached account: test_user_1742588041_1
[2025-03-21 15:14:04] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:14:04] [INFO] [Scanner] Using cached account: test_user_1742588041_1
[2025-03-21 15:14:04] [INFO] [Scanner] Logging in as user 'test_user_1742588041_gt2yx9@example.com'
[2025-03-21 15:14:04] [WARNING] [Scanner] Login successful but no auth token found in response
[2025-03-21 15:14:04] [INFO] [Scanner] Failed to login as test user, skipping JWT manipulation test
[2025-03-21 15:14:04] [INFO] [orchestrator] Completed scanner 'broken_access_control' in 3.05 seconds
[2025-03-21 15:14:04] [INFO] [orchestrator] Starting scanner: excessive_data_exposure
[2025-03-21 15:14:04] [INFO] [Scanner] Starting excessive data exposure scanner
[2025-03-21 15:14:04] [INFO] [Scanner] Testing debug endpoint: /users/v1/_debug
[2025-03-21 15:14:04] [INFO] [Scanner] Debug endpoint returned a 'users' array with 64 items
[2025-03-21 15:14:04] [INFO] [Scanner] Found sensitive field in debug response: password
[2025-03-21 15:14:04] [INFO] [Scanner] Evidence saved to /Users/rvance/Documents/scannerapi/web-interface/results/results_20250321151404.json
[2025-03-21 15:14:04] [INFO] [Scanner] Found CRITICAL severity vulnerability: Excessive Data Exposure - Debug Endpoint at /users/v1/_debug
[2025-03-21 15:14:04] [INFO] [Scanner] Found excessive data exposure in debug endpoint with 1 sensitive fields
[2025-03-21 15:14:04] [INFO] [Scanner] Testing for sensitive data in API responses
[2025-03-21 15:14:04] [INFO] [Scanner] Registering test user: test_user_1742588041_5ib0nn
[2025-03-21 15:14:04] [INFO] [Scanner] Testing user endpoint for sensitive data: /users/v1/{username}
[2025-03-21 15:14:04] [INFO] [orchestrator] Completed scanner 'excessive_data_exposure' in 0.02 seconds
[2025-03-21 15:14:04] [INFO] [orchestrator] Starting scanner: mass_assignment
[2025-03-21 15:14:04] [INFO] [Scanner] Starting mass assignment vulnerability scanner
[2025-03-21 15:14:04] [INFO] [Scanner] Testing create and update flow for mass assignment
[2025-03-21 15:14:04] [INFO] [Scanner] Attempting to create user with endpoint: /users/v1/register
[2025-03-21 15:14:04] [INFO] [Scanner] Successfully created test user with endpoint: /users/v1/register
[2025-03-21 15:14:04] [INFO] [Scanner] Using email as user identifier
[2025-03-21 15:14:13] [INFO] [Scanner] Testing for role change vulnerabilities (admin to regular user and vice versa)
[2025-03-21 15:14:13] [INFO] [Scanner] Found admin user: True, regular user: True
[2025-03-21 15:14:13] [INFO] [Scanner] Attempting to make admin for user 'name1'
[2025-03-21 15:14:13] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 15:14:14] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 15:14:14] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 15:14:15] [INFO] [Scanner] Attempting to revoke admin for user 'admin'
[2025-03-21 15:14:15] [INFO] [Scanner] PUT request to change role was rejected with status code: 405
[2025-03-21 15:14:15] [INFO] [Scanner] PATCH request to change role was rejected with status code: 405
[2025-03-21 15:14:16] [INFO] [Scanner] POST request to change role was rejected with status code: 405
[2025-03-21 15:14:16] [INFO] [Scanner] Testing for mass assignment vulnerabilities during user registration
[2025-03-21 15:14:16] [INFO] [Scanner] Attempting to register user 'test_mass_reg_1742588056' with admin privileges
[2025-03-21 15:14:16] [INFO] [Scanner] Successfully registered user 'test_mass_reg_1742588056'
[2025-03-21 15:14:17] [INFO] [Scanner] Found CRITICAL severity vulnerability: Mass Assignment During Registration at /users/v1/register
[2025-03-21 15:14:17] [INFO] [orchestrator] Completed scanner 'mass_assignment' in 12.74 seconds
[2025-03-21 15:14:17] [INFO] [orchestrator] Starting scanner: unauthorized_password_change
[2025-03-21 15:14:17] [INFO] [Scanner] Starting unauthorized password change scanner
[2025-03-21 15:14:17] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 15:14:17] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:14:17] [INFO] [Scanner] Found 67 existing accounts
[2025-03-21 15:14:17] [INFO] [Scanner] Registering new test user 'test_user_1742588041_76iicd' with admin privileges
[2025-03-21 15:14:17] [INFO] [Scanner] Successfully registered test user 'test_user_1742588041_76iicd'
[2025-03-21 15:14:17] [INFO] [Scanner] Verifying test user 'test_user_1742588041_76iicd' was created
[2025-03-21 15:14:18] [INFO] [Scanner] Retrieving existing accounts from /users/v1/_debug
[2025-03-21 15:14:18] [INFO] [Scanner] Found 68 existing accounts
[2025-03-21 15:14:18] [INFO] [Scanner] Verified test user 'test_user_1742588041_76iicd' was created successfully
[2025-03-21 15:14:18] [INFO] [Scanner] Logging in as test user 'test_user_1742588041_76iicd'
[2025-03-21 15:14:18] [INFO] [Scanner] Successfully logged in as test user and obtained auth token
[2025-03-21 15:14:18] [INFO] [Scanner] Attempting to change password for user 'name1'
[2025-03-21 15:14:18] [INFO] [Scanner] Password change request for user 'name1' was accepted
[2025-03-21 15:14:18] [INFO] [Scanner] Verifying password change by attempting to login as 'name1'
[2025-03-21 15:14:18] [INFO] [Scanner] Successfully logged in as 'name1' with the new password - vulnerability confirmed!
[2025-03-21 15:14:18] [INFO] [Scanner] Found CRITICAL severity vulnerability: Unauthorized Password Change at /users/v1/name1/password
[2025-03-21 15:14:18] [INFO] [orchestrator] Completed scanner 'unauthorized_password_change' in 1.04 seconds
[2025-03-21 15:14:18] [INFO] [orchestrator] Starting scanner: unrestricted_account_creation
[2025-03-21 15:14:18] [INFO] [Scanner] Starting unrestricted account creation and authorization scanner
[2025-03-21 15:14:18] [INFO] [Scanner] Creating 3 dedicated test accounts for use by other scanners
[2025-03-21 15:14:18] [INFO] [Scanner] Creating dedicated test account 1/3: test_account_1742588058_standard_w8c3@example.com
[2025-03-21 15:14:18] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:18] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:18] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:18] [WARNING] [Scanner] Failed to create dedicated test account 1/3: test_account_1742588058_standard_w8c3@example.com, status code: 404
[2025-03-21 15:14:19] [INFO] [Scanner] Creating dedicated test account 2/3: test_account_1742588058_premium_lza8@example.com
[2025-03-21 15:14:19] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:19] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:19] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:19] [WARNING] [Scanner] Failed to create dedicated test account 2/3: test_account_1742588058_premium_lza8@example.com, status code: 404
[2025-03-21 15:14:20] [INFO] [Scanner] Creating dedicated test account 3/3: test_account_1742588058_admin_4uny@example.com
[2025-03-21 15:14:20] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:20] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:20] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:20] [WARNING] [Scanner] Failed to create dedicated test account 3/3: test_account_1742588058_admin_4uny@example.com, status code: 404
[2025-03-21 15:14:21] [INFO] [Scanner] Created 0 dedicated test accounts out of 3 attempted
[2025-03-21 15:14:21] [INFO] [Scanner] Testing basic account creation
[2025-03-21 15:14:21] [INFO] [core.account_cache] Using cached account: test_user_1742588041_2
[2025-03-21 15:14:21] [INFO] [core.account_cache] Saved 3 accounts to cache
[2025-03-21 15:14:21] [INFO] [Scanner] Using cached account: test_user_1742588041_2
[2025-03-21 15:14:21] [INFO] [core.auth_handler] Authentication required for /auth/sign-in, retrying with auth
[2025-03-21 15:14:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:21] [WARNING] [Scanner] Failed to create test account: test_user_1742588041_2, status code: 404
[2025-03-21 15:14:21] [INFO] [Scanner] Testing account creation without proper validation
[2025-03-21 15:14:21] [INFO] [Scanner] Testing: Empty username
[2025-03-21 15:14:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:21] [WARNING] [Scanner] Unexpected status code 404 for: Empty username
[2025-03-21 15:14:22] [INFO] [Scanner] Testing: Very short username
[2025-03-21 15:14:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:22] [WARNING] [Scanner] Unexpected status code 404 for: Very short username
[2025-03-21 15:14:22] [INFO] [Scanner] Testing: SQL injection in username
[2025-03-21 15:14:22] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:22] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:22] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:22] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in username
[2025-03-21 15:14:23] [INFO] [Scanner] Testing: More complex SQL injection in username
[2025-03-21 15:14:23] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:23] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:23] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:23] [WARNING] [Scanner] Unexpected status code 404 for: More complex SQL injection in username
[2025-03-21 15:14:23] [INFO] [Scanner] Testing: XSS in username
[2025-03-21 15:14:23] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:23] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:23] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:23] [WARNING] [Scanner] Unexpected status code 404 for: XSS in username
[2025-03-21 15:14:24] [INFO] [Scanner] Testing: More complex XSS in username
[2025-03-21 15:14:24] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:24] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:24] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:24] [WARNING] [Scanner] Unexpected status code 404 for: More complex XSS in username
[2025-03-21 15:14:24] [INFO] [Scanner] Testing: Empty email
[2025-03-21 15:14:24] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:24] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:24] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:24] [WARNING] [Scanner] Unexpected status code 404 for: Empty email
[2025-03-21 15:14:25] [INFO] [Scanner] Testing: Invalid email format (no @)
[2025-03-21 15:14:25] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:25] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:25] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:25] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no @)
[2025-03-21 15:14:25] [INFO] [Scanner] Testing: Invalid email format (no domain)
[2025-03-21 15:14:25] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:25] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:25] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:25] [WARNING] [Scanner] Unexpected status code 404 for: Invalid email format (no domain)
[2025-03-21 15:14:26] [INFO] [Scanner] Testing: SQL injection in email
[2025-03-21 15:14:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:26] [WARNING] [Scanner] Unexpected status code 404 for: SQL injection in email
[2025-03-21 15:14:26] [INFO] [Scanner] Testing: Empty password
[2025-03-21 15:14:26] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:26] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:26] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:26] [WARNING] [Scanner] Unexpected status code 404 for: Empty password
[2025-03-21 15:14:27] [INFO] [Scanner] Testing: Short password
[2025-03-21 15:14:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:27] [WARNING] [Scanner] Unexpected status code 404 for: Short password
[2025-03-21 15:14:27] [INFO] [Scanner] Testing: Common password
[2025-03-21 15:14:27] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:27] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:27] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:27] [WARNING] [Scanner] Unexpected status code 404 for: Common password
[2025-03-21 15:14:28] [INFO] [Scanner] Testing: Password same as username
[2025-03-21 15:14:28] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:28] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:28] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:28] [WARNING] [Scanner] Unexpected status code 404 for: Password same as username
[2025-03-21 15:14:28] [INFO] [Scanner] Testing account creation rate limiting
[2025-03-21 15:14:28] [INFO] [Scanner] Phase 1: Normal rate limiting test with 15 requests
[2025-03-21 15:14:28] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:28] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:28] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:28] [INFO] [Scanner] Unexpected status code 404 for account 1/15
[2025-03-21 15:14:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:29] [INFO] [Scanner] Unexpected status code 404 for account 2/15
[2025-03-21 15:14:29] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:29] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:29] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:29] [INFO] [Scanner] Unexpected status code 404 for account 3/15
[2025-03-21 15:14:29] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:14:29] [INFO] [Scanner] Rate limiting properly implemented, triggered after 0 account creations
[2025-03-21 15:14:29] [INFO] [Scanner] Phase 3: Adapting to rate limiting to find optimal creation rate
[2025-03-21 15:14:29] [INFO] [Scanner] Finding optimal account creation rate that avoids rate limiting
[2025-03-21 15:14:29] [INFO] [Scanner] Testing creation rate with 1.00 seconds delay
[2025-03-21 15:14:32] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:32] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:32] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:32] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:14:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:34] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:14:34] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:34] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:34] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:34] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:14:34] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:14:34] [INFO] [Scanner] Rate limiting still triggered at 1.00s delay, increasing
[2025-03-21 15:14:34] [INFO] [Scanner] Testing creation rate with 5.75 seconds delay
[2025-03-21 15:14:37] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:37] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:37] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:38] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:14:43] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:43] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:43] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:43] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:14:50] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:50] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:50] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:50] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:14:50] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:14:50] [INFO] [Scanner] Rate limiting still triggered at 5.75s delay, increasing
[2025-03-21 15:14:50] [INFO] [Scanner] Testing creation rate with 8.12 seconds delay
[2025-03-21 15:14:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:14:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:14:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:14:53] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:15:01] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:01] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:01] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:01] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:15:09] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:09] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:09] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:09] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:15:09] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:15:09] [INFO] [Scanner] Rate limiting still triggered at 8.12s delay, increasing
[2025-03-21 15:15:09] [INFO] [Scanner] Testing creation rate with 9.31 seconds delay
[2025-03-21 15:15:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:12] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:15:21] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:21] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:21] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:21] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:15:30] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:30] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:30] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:30] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:15:30] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:15:30] [INFO] [Scanner] Rate limiting still triggered at 9.31s delay, increasing
[2025-03-21 15:15:30] [INFO] [Scanner] Testing creation rate with 9.91 seconds delay
[2025-03-21 15:15:33] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:33] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:33] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:33] [INFO] [Scanner] Unexpected status code 404 for account 1/3
[2025-03-21 15:15:42] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:42] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:42] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:42] [INFO] [Scanner] Unexpected status code 404 for account 2/3
[2025-03-21 15:15:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:53] [INFO] [Scanner] Unexpected status code 404 for account 3/3
[2025-03-21 15:15:53] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:15:53] [INFO] [Scanner] Rate limiting still triggered at 9.91s delay, increasing
[2025-03-21 15:15:53] [INFO] [Scanner] Could not find optimal rate, using conservative 10.00s delay (0.10 req/sec)
[2025-03-21 15:15:53] [INFO] [Scanner] Verifying optimal rate: 0.10 req/sec (10.00s delay)
[2025-03-21 15:15:53] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:15:53] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:15:53] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:15:53] [INFO] [Scanner] Unexpected status code 404 for account 1/10
[2025-03-21 15:16:02] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:02] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:02] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:02] [INFO] [Scanner] Unexpected status code 404 for account 2/10
[2025-03-21 15:16:12] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:12] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:12] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:12] [INFO] [Scanner] Unexpected status code 404 for account 3/10
[2025-03-21 15:16:12] [WARNING] [Scanner] Possible rate limiting detected after 3 consecutive failures
[2025-03-21 15:16:12] [INFO] [Scanner] Rate limiting triggered during verification, adjusting optimal rate
[2025-03-21 15:16:12] [INFO] [Scanner] Found MEDIUM severity vulnerability: Rate-Limited Account Creation at /api/users
[2025-03-21 15:16:12] [INFO] [Scanner] Testing JWT authentication bypass for account creation
[2025-03-21 15:16:12] [INFO] [Scanner] Testing for JWT manipulation to bypass account creation restrictions
[2025-03-21 15:16:12] [INFO] [Scanner] Testing account creation without authentication
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] Authentication appears to be required for account creation: 404
[2025-03-21 15:16:13] [INFO] [Scanner] Creating a test account to obtain a valid JWT token
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] Could not obtain a valid JWT token through normal means, creating a completely forged token
[2025-03-21 15:16:13] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 15:16:13] [INFO] [Scanner] Successfully obtained/created JWT token: eyJhbGciOiJub25lIiwi...
[2025-03-21 15:16:13] [INFO] [Scanner] Created 'none' algorithm token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 15:16:13] [INFO] [Scanner] Testing if 'none' algorithm token can bypass authentication requirements
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] JWT 'none' algorithm attack failed, but no specific JWT validation error was detected
[2025-03-21 15:16:13] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:16:13] [INFO] [Scanner] Created algorithm switch token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
[2025-03-21 15:16:13] [INFO] [Scanner] Testing if algorithm switching (RS256 to HS256) token can bypass authentication requirements
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] JWT algorithm switching (RS256 to HS256) attack failed, but no specific JWT validation error was detected
[2025-03-21 15:16:13] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:16:13] [INFO] [Scanner] Created admin role token: eyJhbGciOiJub25lIiwidHlwIjoiSl...
[2025-03-21 15:16:13] [INFO] [Scanner] Testing if modified payload (added admin role) token can bypass authentication requirements
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] JWT modified payload (added admin role) attack failed, but no specific JWT validation error was detected
[2025-03-21 15:16:13] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:16:13] [INFO] [Scanner] Created completely forged token: eyJhbGciOiJub25lIiwi...
[2025-03-21 15:16:13] [INFO] [Scanner] Testing if completely forged token token can bypass authentication requirements
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] No token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] Forged token response status: 404
[2025-03-21 15:16:13] [INFO] [Scanner] JWT completely forged token attack failed, but no specific JWT validation error was detected
[2025-03-21 15:16:13] [INFO] [Scanner] Found LOW severity vulnerability: Potential JWT Validation Issue at /api/users
[2025-03-21 15:16:13] [INFO] [Scanner] Testing for account enumeration
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /api/users, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [INFO] [Scanner] Testing for unauthorized password change vulnerability
[2025-03-21 15:16:13] [INFO] [Scanner] Retrieving existing accounts from /auth/check
[2025-03-21 15:16:13] [INFO] [core.auth_handler] Authentication required for /auth/check, retrying with auth
[2025-03-21 15:16:13] [INFO] [core.auth_handler] No authentication required
[2025-03-21 15:16:13] [WARNING] [core.auth_handler] Failed to get authentication header
[2025-03-21 15:16:13] [WARNING] [Scanner] Failed to get existing accounts, status code: 404
[2025-03-21 15:16:13] [WARNING] [Scanner] Failed to retrieve existing accounts, skipping unauthorized password change test
[2025-03-21 15:16:13] [INFO] [orchestrator] Completed scanner 'unrestricted_account_creation' in 114.33 seconds
[2025-03-21 15:16:13] [INFO] [orchestrator] Starting scanner: jwt_vulnerabilities
[2025-03-21 15:16:13] [INFO] [Scanner] Starting JWT vulnerabilities scanner
[2025-03-21 15:16:13] [INFO] [Scanner] Using base_url as target URL: http://localhost:5002
[2025-03-21 15:16:13] [INFO] [Scanner] Target base URL: http://localhost:5002
[2025-03-21 15:16:13] [INFO] [Scanner] Login endpoint: /users/v1/login
[2025-03-21 15:16:13] [INFO] [Scanner] User info endpoint: /
[2025-03-21 15:16:13] [INFO] [Scanner] Debug mode: True
[2025-03-21 15:16:13] [INFO] [Scanner] Debug mode enabled, creating a sample JWT token for testing
[2025-03-21 15:16:13] [INFO] [Scanner] Using PyJWT library for token creation
[2025-03-21 15:16:13] [INFO] [Scanner] Creating token with weak key: 'secret'
[2025-03-21 15:16:13] [INFO] [Scanner] Created sample JWT token for testing: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTc0MjU4ODE3MywiZXhwIjoxNzQ1MTgwMTczfQ.guqOBFq64FBaJhvII5iiSLi-txTrljR1Pbu0HLAr5ro
[2025-03-21 15:16:13] [INFO] [Scanner] Enabled simulation of vulnerable responses
[2025-03-21 15:16:13] [INFO] [Scanner] Running JWT vulnerability tests
[2025-03-21 15:16:13] [INFO] [Scanner] Simulate vulnerabilities: True
[2025-03-21 15:16:13] [INFO] [Scanner] JWT Header: {"alg": "HS256", "typ": "JWT"}
[2025-03-21 15:16:13] [INFO] [Scanner] JWT Algorithm: HS256
[2025-03-21 15:16:13] [INFO] [Scanner] JWT Expiration: 2025-04-20 15:16:13 (in 720.0 hours)
[2025-03-21 15:16:13] [INFO] [Scanner] JWT Claim 'sub': 1234567890
[2025-03-21 15:16:13] [INFO] [Scanner] Simulating JWT vulnerabilities as requested
[2025-03-21 15:16:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT 'none' Algorithm Vulnerability at /
[2025-03-21 15:16:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Weak Signing Key at /users/v1/login
[2025-03-21 15:16:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: Missing JWT Signature Validation at /
[2025-03-21 15:16:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Expiration Manipulation at /
[2025-03-21 15:16:13] [INFO] [Scanner] Found CRITICAL severity vulnerability: JWT Token Tampering - None algorithm at /
[2025-03-21 15:16:13] [INFO] [Scanner] Found 5 vulnerabilities
[2025-03-21 15:16:13] [INFO] [Scanner] Finding 1: JWT 'none' Algorithm Vulnerability - CRITICAL
[2025-03-21 15:16:13] [INFO] [Scanner] Finding 2: JWT Weak Signing Key - CRITICAL
[2025-03-21 15:16:13] [INFO] [Scanner] Finding 3: Missing JWT Signature Validation - CRITICAL
[2025-03-21 15:16:13] [INFO] [Scanner] Finding 4: JWT Expiration Manipulation - CRITICAL
[2025-03-21 15:16:13] [INFO] [Scanner] Finding 5: JWT Token Tampering - None algorithm - CRITICAL
[2025-03-21 15:16:13] [INFO] [orchestrator] Completed scanner 'jwt_vulnerabilities' in 0.00 seconds
[2025-03-21 15:16:13] [INFO] [orchestrator] RegexDOS scanner was skipped due to --dos flag set to false
[2025-03-21 15:16:13] [INFO] [orchestrator] Saving results to /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 15:16:13] [INFO] [orchestrator] Scan ID: 20250321151613
[2025-03-21 15:16:13] [INFO] [utils] Ensuring output directory exists: /Users/rvance/Documents/scannerapi/web-interface/results
[2025-03-21 15:16:13] [INFO] [utils] Writing results to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321151613.json
[2025-03-21 15:16:13] [INFO] [utils] Results saved to /Users/rvance/Documents/scannerapi/web-interface/results/20250321151613.json
[2025-03-21 15:16:13] [INFO] [orchestrator] Results saved to: /Users/rvance/Documents/scannerapi/web-interface/results/20250321151613.json
[2025-03-21 15:16:13] [INFO] [orchestrator] Scan completed. Found 15 potential vulnerabilities
