{
  "scan_id": "20250310204419",
  "target": "http://localhost:5002",
  "start_time": "2025-03-10T20:39:14.646035",
  "end_time": "2025-03-10T20:44:19.031034",
  "duration": 304.3850009441376,
  "scanners": [
    {
      "name": "unauthorized_password_change",
      "success": true,
      "duration": 1.0901169776916504,
      "findings": [
        {
          "vulnerability": "Unauthorized Password Change",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/name1/password",
          "details": "The API allows users to change passwords of other users without proper authorization. User 'test_user_1741657154_t6izxu' was able to change the password of user 'name1'.",
          "timestamp": 1741657155.8374941,
          "evidence": {
            "test_user": "test_user_1741657154_t6izxu",
            "target_user": "name1",
            "password_change_request": {
              "endpoint": "/users/v1/name1/password",
              "method": "PUT",
              "headers": {
                "Authorization": "Bearer eyJhbGciOi..."
              },
              "payload": {
                "password": "NewPass@1741657154"
              }
            },
            "verification": {
              "login_successful": true,
              "login_endpoint": "/users/v1/login",
              "login_payload": {
                "username": "name1",
                "password": "NewPass@1741657154"
              }
            }
          },
          "remediation": "Implement proper authorization checks to ensure users can only change their own passwords. Verify the user's identity from the authentication token and compare it with the requested resource.",
          "finding_id": "272c4ddc"
        }
      ],
      "start_time": "2025-03-10T20:39:14.747849",
      "end_time": "2025-03-10T20:39:15.837966"
    },
    {
      "name": "unrestricted_account_creation",
      "success": true,
      "duration": 0.005255937576293945,
      "findings": [
        {
          "vulnerability": "Unrestricted Account Creation - No Rate Limiting",
          "severity": "HIGH",
          "endpoint": "/users/v1/register",
          "details": "The API does not implement rate limiting for account creation. Successfully created 10 accounts in rapid succession without any restrictions.",
          "timestamp": 1741657155.8404381,
          "evidence": {
            "successful_creations": 10,
            "test_count": 10,
            "time_between_requests": "0.1 seconds"
          },
          "remediation": "Implement rate limiting for account creation to prevent abuse and automated account creation attacks.",
          "finding_id": "8e24013c"
        },
        {
          "vulnerability": "Unrestricted Account Creation - Lack of Input Validation",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/register",
          "details": "The API allows account creation with invalid input including SQL injection patterns in the username field. This could potentially lead to SQL injection attacks.",
          "timestamp": 1741657155.841652,
          "evidence": {
            "request": {
              "username": "' OR 1=1 --",
              "email": "sqli@example.com",
              "password": "Test@123456"
            },
            "response": {
              "status_code": 201,
              "body": "{\"id\": 123, \"username\": \"' OR 1=1 --\", \"email\": \"sqli@example.com\"}"
            }
          },
          "remediation": "Implement proper input validation and sanitization for all user registration fields to prevent SQL injection and other injection attacks.",
          "finding_id": "b256be24"
        },
        {
          "vulnerability": "Unrestricted Account Creation - Username Enumeration",
          "severity": "MEDIUM",
          "endpoint": "/users/v1/register",
          "details": "The API reveals whether a username already exists during account creation, which can be used for user enumeration attacks to discover valid usernames.",
          "timestamp": 1741657155.8429399,
          "evidence": {
            "request": {
              "username": "existing_user",
              "email": "existing@example.com",
              "password": "Test@123456"
            },
            "response": {
              "status_code": 400,
              "body": "{\"error\": \"Username already exists\"}"
            }
          },
          "remediation": "Use generic error messages that don't reveal whether a username exists. For example, use 'Invalid registration information' instead of 'Username already exists'.",
          "finding_id": "51649a1d"
        }
      ],
      "start_time": "2025-03-10T20:39:15.838739",
      "end_time": "2025-03-10T20:39:15.843995"
    },
    {
      "name": "broken_access_control",
      "success": true,
      "duration": 3.1439647674560547,
      "findings": [
        {
          "vulnerability": "Privilege Escalation During Registration",
          "severity": "HIGH",
          "endpoint": "/users/v1/register",
          "details": "Users can register accounts with administrative privileges by including the 'admin' field in the registration request.",
          "timestamp": 1741657156.8953311,
          "evidence": {
            "registration_payload": {
              "username": "admin_user_1741657154_js6530",
              "email": "admin_user_1741657154_js6530@example.com",
              "password": "REDACTED",
              "admin": true
            },
            "created_user": {
              "admin": true,
              "email": "admin_user_1741657154_js6530@example.com",
              "password": "Admin@1741657154",
              "username": "admin_user_1741657154_js6530"
            }
          },
          "remediation": "Implement server-side validation to ignore or reject privilege-related fields in registration requests. Never trust client-provided values for privilege levels.",
          "finding_id": "9042ae11"
        }
      ],
      "start_time": "2025-03-10T20:39:15.844951",
      "end_time": "2025-03-10T20:39:18.988916"
    },
    {
      "name": "broken_authentication",
      "success": true,
      "duration": 0.5771100521087646,
      "findings": [
        {
          "vulnerability": "Exposed Credentials via Debug Endpoint",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/_debug",
          "details": "The API exposes user credentials via the debug endpoint (/users/v1/_debug). These credentials can be used to login and obtain valid authentication tokens.",
          "timestamp": 1741657159.01001,
          "evidence": {
            "debug_endpoint": "/users/v1/_debug",
            "login_endpoint": "/users/v1/login",
            "username": "name1",
            "password_exposed": true,
            "login_successful": true
          },
          "remediation": "Remove or properly secure the debug endpoint. Never expose user credentials in API responses. Implement proper authentication controls and ensure debug endpoints are not accessible in production environments.",
          "finding_id": "77ac5449"
        }
      ],
      "start_time": "2025-03-10T20:39:18.989954",
      "end_time": "2025-03-10T20:39:19.567064"
    },
    {
      "name": "jwt_vulnerabilities",
      "success": true,
      "duration": 0.013630867004394531,
      "findings": [
        {
          "vulnerability": "Configured Long-Lived JWT Tokens",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/login",
          "details": "The system is configured to issue JWT tokens with an extremely long lifetime of 355.0 days. This significantly increases the risk of token theft and misuse.",
          "timestamp": 1741657159.570852,
          "evidence": {
            "configured_expiration_days": 355.0,
            "recommended_maximum_days": 1
          },
          "remediation": "Configure shorter expiration times for JWT tokens (15-60 minutes is recommended). For longer sessions, implement refresh tokens with proper security controls.",
          "finding_id": "52ebac95"
        },
        {
          "vulnerability": "JWT 'none' Algorithm Vulnerability",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/me",
          "details": "The API accepts JWT tokens with the 'none' algorithm, allowing authentication bypass.",
          "timestamp": 1741657159.576755,
          "evidence": null,
          "remediation": "Ensure that the JWT library explicitly rejects tokens with the 'none' algorithm.",
          "finding_id": "80214e93"
        },
        {
          "vulnerability": "JWT Weak Signing Key",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/login",
          "details": "The API uses a weak signing key ('secret') for JWT tokens, allowing token forgery.",
          "timestamp": 1741657159.577108,
          "evidence": null,
          "remediation": "Use a strong, randomly generated signing key with at least 256 bits of entropy.",
          "finding_id": "8ab377cf"
        },
        {
          "vulnerability": "Missing JWT Signature Validation",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/me",
          "details": "The API does not properly validate JWT signatures, allowing attackers to modify token content without detection.",
          "timestamp": 1741657159.5775108,
          "evidence": null,
          "remediation": "Ensure that the JWT library properly validates token signatures and rejects tokens with invalid signatures.",
          "finding_id": "74ca9342"
        },
        {
          "vulnerability": "JWT Expiration Manipulation",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/me",
          "details": "The API does not properly validate the integrity of JWT tokens, allowing attackers to modify the expiration time.",
          "timestamp": 1741657159.57792,
          "evidence": null,
          "remediation": "Ensure that the JWT library properly validates token signatures and rejects tokens with invalid signatures.",
          "finding_id": "6244d472"
        },
        {
          "vulnerability": "JWT Token Tampering - None algorithm",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/me",
          "details": "The API does not properly validate the integrity of JWT tokens, allowing attackers to modify the payload using None algorithm to gain elevated privileges.",
          "timestamp": 1741657159.578332,
          "evidence": null,
          "remediation": "Ensure that the JWT library properly validates token signatures and rejects tokens with invalid signatures or using the 'none' algorithm.",
          "finding_id": "76fcf4c8"
        }
      ],
      "start_time": "2025-03-10T20:39:19.568112",
      "end_time": "2025-03-10T20:39:19.581743"
    },
    {
      "name": "excessive_data_exposure",
      "success": true,
      "duration": 0.044053077697753906,
      "findings": [
        {
          "vulnerability": "Excessive Data Exposure - Debug Endpoint",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/_debug",
          "details": "The API exposes a debug endpoint that returns sensitive user data including admin, password. This endpoint returned data for 531 users, which could lead to unauthorized access to sensitive information.",
          "timestamp": 1741657159.612633,
          "evidence": {
            "sensitive_fields": [
              "admin",
              "password"
            ],
            "total_users_exposed": 531,
            "status_code": 200,
            "evidence_file": "/Users/rvance/Documents/scannerapi/results/results_20250310203919.json"
          },
          "remediation": "Remove or properly secure debug endpoints in production environments. Implement proper authentication and authorization controls. Consider implementing a separate API for debugging that requires elevated privileges.",
          "finding_id": "ac1a5a25"
        }
      ],
      "start_time": "2025-03-10T20:39:19.582974",
      "end_time": "2025-03-10T20:39:19.627027"
    },
    {
      "name": "sql_injection",
      "success": true,
      "duration": 287.57410311698914,
      "findings": [
        {
          "vulnerability": "SQL Injection - Error Based",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/{username}",
          "details": "The API endpoint is vulnerable to SQL injection attacks. A simple single quote in the username parameter causes a SQL error, indicating that user input is not properly sanitized before being used in database queries.",
          "timestamp": 1741657159.639512,
          "evidence": {
            "endpoint": "/users/v1/{username}",
            "vulnerable_parameter": "username",
            "payload": "'",
            "injection_point": "path",
            "response": {
              "status_code": 500,
              "body": "<!doctype html>\n<html lang=en>\n  <head>\n    <title>sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unrecognized token: \"'name1''\"\n[SQL: SELECT * FROM users WHERE username = 'name1'']\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n // Werkzeug Debugger</title>\n    <link rel=\"stylesheet\" href=\"?__debugger__=yes&amp;cmd=resource&amp;f=style.css\">\n    <link rel=\"shortcut icon\"\n        href=\"?__debugger__=yes&amp;cmd=resource&amp;f=console.png\">\n    <script src=\"?__debugger__=yes&amp;cmd=resource&amp;f=debugger.js\"></script>\n    <script>\n      var CONSOLE_MODE = false,\n          EVALEX = true,\n          EVALEX_TRUSTED = false,\n          SECRET = \"OmOrj28fPnOVe3rjI5tU\";\n    </script>\n  </head>\n  <body style=\"background-color: #fff\">\n    <div class=\"debugger\">\n<h1>OperationalError</h1>\n<div class=\"detail\">\n  <p class=\"errormsg\">sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unrecognized token: &#34;&#39;name1&#39;&#39;&#34;\n[SQL: SELECT * FROM users WHER"
            },
            "request": {
              "method": "GET",
              "url": "http://localhost:5002/users/v1/name1'",
              "headers": {
                "User-Agent": "python-requests/2.31.0",
                "Accept-Encoding": "gzip, deflate, zstd",
                "Accept": "application/json",
                "Connection": "keep-alive",
                "Content-Type": "application/json"
              },
              "params": null,
              "data": null,
              "json": null
            }
          },
          "remediation": "Use parameterized queries or prepared statements instead of building SQL queries through string concatenation. Implement proper input validation and sanitization for all user inputs.",
          "finding_id": "56bfad8b"
        }
      ],
      "start_time": "2025-03-10T20:39:19.627883",
      "end_time": "2025-03-10T20:44:07.201986"
    },
    {
      "name": "mass_assignment",
      "success": true,
      "duration": 11.824892044067383,
      "findings": [
        {
          "vulnerability": "Mass Assignment During Registration",
          "severity": "CRITICAL",
          "endpoint": "/users/v1/register",
          "details": "The API allows setting admin privileges during user registration via mass assignment.",
          "timestamp": 1741657459.028878,
          "evidence": {
            "request": {
              "method": "POST",
              "endpoint": "/users/v1/register",
              "payload": {
                "username": "test_mass_reg_1741657457",
                "email": "test_mass_reg_1741657457@example.com",
                "password": "Test@1741657457",
                "admin": true
              }
            },
            "response": {
              "status_code": 200,
              "body": "{\"message\": \"Successfully registered. Login to receive an auth token.\", \"status\": \"success\"}"
            },
            "verification": {
              "user": "test_mass_reg_1741657457",
              "admin_status": true
            }
          },
          "remediation": "Implement proper server-side filtering of request parameters during registration to prevent setting of sensitive fields like 'admin'.",
          "finding_id": "801dc8b5"
        }
      ],
      "start_time": "2025-03-10T20:44:07.204649",
      "end_time": "2025-03-10T20:44:19.029541"
    },
    {
      "name": "regex_dos",
      "success": true,
      "duration": 0,
      "findings": [
        {
          "vulnerability": "RegexDOS Scanner Skipped",
          "severity": "INFO",
          "endpoint": "N/A",
          "details": "The RegexDOS scanner was skipped due to the --dos flag being set to false.",
          "remediation": "To run the RegexDOS scanner, use the --dos true flag."
        }
      ],
      "start_time": "2025-03-10T20:44:19.031019",
      "end_time": "2025-03-10T20:44:19.031022"
    }
  ],
  "metadata": {
    "config_file": "config.yml",
    "swagger_file": "tests/sample_openapi.yaml",
    "openapi": {
      "spec_path": "tests/sample_openapi.yaml",
      "endpoint_count": 14,
      "source": "openapi"
    }
  },
  "summary": {
    "total_scanners": 9,
    "successful_scanners": 9,
    "failed_scanners": 0,
    "total_findings": 16
  }
}